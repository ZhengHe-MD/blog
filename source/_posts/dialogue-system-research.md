---
title: å¯¹è¯ç³»ç»Ÿè°ƒç ”æŠ¥å‘Š
date: 2021-07-24 09:37:30
tags:
- system design
---

ä»Šå¹´ 6 æœˆåº•ï¼Œç”±äºå·¥ä½œéœ€è¦ï¼ŒèŠ±äº†ä¸¤å‘¨æ—¶é—´è°ƒç ”å¯¹è¯ç³»ç»Ÿï¼Œå¹¶åœ¨å…¬å¸å†…éƒ¨åšäº†ä¸€æ¬¡è°ƒç ”æŠ¥å‘Šã€‚æœ¬æ–‡æ„åœ¨å°†æ­¤æŠ¥å‘Šæ•´ç†æˆæ–‡å­—ç‰ˆï¼Œç®—æ˜¯å¯¹è¿™æ®µæ—¶é—´ä»˜å‡ºçš„ä¸€ä¸ªäº¤ä»£ã€‚

<!-- more -->

å¦‚æœä½ å¯¹è¿™ä¸ªé¢†åŸŸæ²¡æœ‰è¿‡äº†è§£ï¼Œæ­£å¥½ä½ ä¹Ÿå¯¹æ­¤æ„Ÿå…´è¶£ï¼Œå¸Œæœ›æœ¬æ–‡èƒ½å¤Ÿå¸®åŠ©ä½ ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æå‡ä½ å¯¹ã€Œå¯¹è¯ç³»ç»Ÿã€çš„ç†è§£ï¼š

* é—®é¢˜èƒŒæ™¯
* ä½¿ç”¨åœºæ™¯
* åŸºæœ¬æ¦‚å¿µ
* æ„å»ºæ–¹å¼
* åŸºæœ¬æ¶æ„

æœ€åå°†ä»¥ [Rasa](https://github.com/RasaHQ/rasa) ä¸ºä¾‹ï¼Œä»‹ç»ä¸€ä¸ªçœŸå®çš„å¯¹è¯ç³»ç»Ÿé¡¹ç›®ã€‚

## èƒŒæ™¯çŸ¥è¯†

> â„¹ï¸ æœ¬èŠ‚å†…å®¹ä¸»è¦æ¥è‡ªäº Speech and Language Processing è¿™æœ¬ä¹¦çš„[ç¬¬ 24 ç« ](https://web.stanford.edu/~jurafsky/slp3/24.pdf)

å¯¹è¯ç³»ç»Ÿï¼Œé¡¾åæ€ä¹‰æ˜¯ç”¨æ¥ä¸çœŸäººå¯¹è¯çš„ç³»ç»Ÿã€‚è¦åšå¥½è¿™æ ·çš„ç³»ç»Ÿï¼Œäº†è§£ã€å­¦ä¹ å’Œç ”ç©¶ã€Œäººç±»å¯¹è¯çš„ç‰¹ç‚¹ã€å¾ˆæœ‰å¿…è¦ã€‚

### äººç±»å¯¹è¯çš„ç‰¹ç‚¹

äººç±»å¯¹è¯çš„ç‰¹ç‚¹ç†è®ºä¸Šå±äºè‡ªç„¶è¯­è¨€å­¦çš„ç ”ç©¶èŒƒç•´ï¼Œå†…å®¹ä¸°å¯Œï¼Œè¿™é‡Œä»…æ‘˜å–å…¶ä¸­ä¸€äº›è¦ç‚¹ã€‚ä½†å¦‚æœæœ‰ä¸€å¤©ä½ æƒ³è¦æŠŠå¯¹è¯ç³»ç»Ÿåšåˆ°æè‡´ï¼Œç³»ç»Ÿåœ°å­¦ä¹ æ›´å¤šè‡ªç„¶è¯­è¨€ç ”ç©¶æˆæœè‚¯å®šèƒ½è‡ªåº•å‘ä¸Šåœ°å¸®åŠ©åˆ°ä½ ã€‚

* è½®æ¬¡ (turns)ï¼šå…¸å‹çš„å¯¹è¯é€šå¸¸ç”±ä»¥å¯¹è¯åŒæ–¹è½®æµå‘è¨€çš„å½¢å¼å‡ºç°ï¼Œä¸€æ¥ä¸€å›åˆç§°ä¸€è½® (turn)ï¼Œæ¥å›å¤šæ¬¡è¢«ç§°ä¸ºå¤šè½®å¯¹è¯ã€‚
* å¯¹è¯è¡Œä¸º (dialogue acts)ï¼šäººä»¬çš„æ¯æ¬¡å‘è¨€æˆ–å¤šæˆ–å°‘éƒ½ä¼šå¸¦ç€ä¸€äº›ç›®çš„ï¼Œå³å¯ä»¥æ˜¯ç²—ç²’åº¦çš„ï¼Œå¦‚è¡¨è¿° (constatives)ã€è¯·æ±‚ (requests)ã€æŒ‡ä»¤ (directives)ã€æ‰¿è¯º (commissives)ã€è¡¨æ€ (acknowledgements)ã€é—®é¢˜ (questions)ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»†ç²’åº¦çš„ï¼Œå¦‚è¯¢é—®å¤©æ°”ã€é¢„çº¦æ—¶é—´ã€é¢„å®šæœºç¥¨ç­‰ç­‰ã€‚
* å…±è¯†ç¡®è®¤ (grounding)ï¼šåœ¨å¯¹è¯è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†ä¿è¯åŒæ–¹çš„è®¤è¯†ä¸€è‡´ï¼Œæ²Ÿé€šè¿‡ç¨‹ä¸­ä¼šé€šè¿‡å„ç§æ–¹å¼ç¡®è®¤å¯¹æ–¹çš„æƒ³æ³•ã€‚ç¡®è®¤æ–¹å¼å¤§è‡´å¯ä»¥åˆ†ä¸ºæ˜¾å¼å’Œéšå¼ä¸¤ç§ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š
  * æ˜¾å¼ï¼š
    * Aï¼šæˆ‘è‚šå­åœ¨å«â€¦â€¦
    * Bï¼šä½ æ˜¯ä¸æ˜¯æƒ³åƒåˆé¥­äº†ï¼Ÿ
  * éšå¼ï¼š
    * Aï¼šæˆ‘ä»Šå¤©æƒ³å¿«ç‚¹å»ä¸Šæµ·â€¦â€¦
    * Bï¼šå¥½çš„ï¼Œé‚£ä½ æƒ³ä»é¦–éƒ½æœºåœºè¿˜æ˜¯å¤§å…´æœºåœºå‡ºå‘ï¼Ÿ(éšå«ç¡®è®¤å‡ºè¡Œæ–¹å¼)
* å¯¹è¯ç»“æ„ (dialogue structure)ï¼šé€šè¿‡åˆ†æä¸åŒçš„å¯¹è¯ï¼Œæˆ‘ä»¬ä¼šå‘ç°å¯¹è¯å¸¸å¸¸ç”±åŸºæœ¬é—®ç­”åŠ ä¸Šä¸€äº›ç‰¹æ®Šå˜åŒ–æ„æˆã€‚ç‰¹æ®Šå˜åŒ–åŒ…æ‹¬é¢˜å¤–è¯ (side sequence)ã€å‰ç½®è¯­å¥ (presequences)ã€åç½®è¯­å¥ (postsequences)ã€é‡å¤ç¡®è®¤ (clarification) ç­‰ç­‰ã€‚
* ä¸»å¯¼æ€§ (initiative)ï¼šå½“å¯¹è¯ä¸­æœ‰ä¸€æ–¹ä¸€ç›´åœ¨å•å‘è·å–å¦ä¸€æ–¹ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬ç§°å‰è€…ä¸ºä¸»åŠ¨æ–¹ï¼Œåè€…ä¸ºè¢«åŠ¨æ–¹ã€‚åœ¨å¯¹è¯ç³»ç»Ÿä¸­ï¼Œå¯¹è¯åŒæ–¹æ˜¯ç”¨æˆ· (user) å’Œç³»ç»Ÿ (system)ï¼Œé‚£ä¹ˆä»ä¸»å¯¼æ€§å‡ºå‘ï¼Œå¯¹è¯ç³»ç»Ÿå¯ä»¥è¢«åˆ†ä¸ºä¸‰ç±»ï¼šç”¨æˆ·ä¸»å¯¼ (user-initiative)ã€ç³»ç»Ÿä¸»å¯¼ (system-initiative) å’Œæ··åˆä¸»å¯¼ (mixed initiative)ã€‚
* æ¨ç†å’Œéšå–» (inference & implicature)ï¼šæ‰€è°“å«æ²™å°„å½±ã€è¯ä¸­å¸¦åˆºã€æŒ‡æ¡‘éª‚æ§ã€æ‹å¼¯æŠ¹è§’éƒ½æ˜¯æ¨ç†å’Œéšå–»çš„è‰ºæœ¯ã€‚å½“ç„¶ï¼Œæ¨ç†å’Œéšå–»ä¹Ÿå¯ç”¨äºè¡¨è¾¾éè´Ÿé¢çš„å«ä¹‰ï¼Œè¿™é‡Œå°±ä¸å±•å¼€æè¿°ã€‚

### å¸¸è§ä½¿ç”¨åœºæ™¯

å¯¹è¯ç³»ç»Ÿæœ€å¸¸è§çš„ä¸‰ä¸ªä½¿ç”¨åœºæ™¯æ˜¯ï¼šé—®ç­”ã€åŠ©æ‰‹å’ŒèŠå¤©ï¼Œä¸‰è€…ä»å‰å¾€åéš¾åº¦ã€å¤æ‚åº¦é€æ¸å¢åŠ ã€‚

#### é—®ç­”

é—®ç­”åœºæ™¯å¸¸è§äºæ™ºèƒ½å®¢æœç³»ç»Ÿï¼Œé—®é¢˜å’Œç­”æ¡ˆéƒ½æ¯”è¾ƒå›ºå®šï¼ŒèƒŒåå¸¸å¸¸ä¸çŸ¥è¯†åº“æŒ‚é’©ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥å°†é—®ç­”ç³»ç»Ÿç†è§£æˆæ˜¯ç”¨å¯¹è¯çš„æ–¹å¼å¿«é€Ÿæ£€ç´¢ä½¿ç”¨æ–‡æ¡£ä¸­çš„ frequently asked question (FAQ)ã€‚åœ¨é—®ç­”åœºæ™¯ä¸­ï¼Œç”¨æˆ·æ˜ç¡®åœ°çŸ¥é“ä¸ä¹‹å¯¹è¯çš„ä¸æ˜¯çœŸäººï¼Œå› æ­¤ä¹Ÿä¸ä¼šä½¿ç”¨å¤æ‚çš„å¯¹è¯ç»“æ„ï¼Œä¸»è¦ä»¥å•è½®å¯¹è¯çš„å½¢å¼å‘ˆç°ï¼Œç”¨æˆ·å ä¸»å¯¼ã€‚

#### åŠ©æ‰‹

åŠ©æ‰‹åœºæ™¯å¸¸è§äºæ™ºèƒ½è®¾å¤‡ä¸Šçš„è¯­éŸ³åŠ©æ‰‹ï¼Œå¦‚ [Siri](https://www.apple.com/siri/)ã€[Alexa](https://developer.amazon.com/en-US/alexa) å’Œ [Google Assistant](https://assistant.google.com/) ç­‰ï¼Œå®ƒçš„é—®é¢˜å’Œç­”æ¡ˆç›¸å¯¹å›ºå®šï¼ŒèƒŒåä¹Ÿå¯èƒ½ä¸çŸ¥è¯†åº“æŒ‚é’©ã€‚åŒæ—¶ï¼ŒåŠ©æ‰‹éœ€è¦å’Œè®¸å¤šä¸‰æ–¹æœåŠ¡å¯¹æ¥ï¼Œä»¥å®Œæˆç”¨æˆ·äº¤ä»˜çš„ä»»åŠ¡ï¼Œå› æ­¤ä¹Ÿå¸¸å¸¸è¢«ç§°ä¸ºä»»åŠ¡æœºå™¨äºº (task bot)ã€‚

ä½†ä¸é—®ç­”åœºæ™¯ä¸åŒï¼ŒåŠ©æ‰‹é¢å¯¹é—®é¢˜ç»™å‡ºçš„ç­”æ¡ˆæˆ–åšå‡ºçš„è¡ŒåŠ¨å¯èƒ½éšç€ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯å˜åŒ–è€Œå˜åŒ–ã€‚æ¯”å¦‚ç”¨æˆ·è¦è®¢æœºç¥¨ï¼ŒåŠ©æ‰‹éœ€è¦çŸ¥é“å‡ºå‘åœ°ã€ç›®çš„åœ°ã€æ—¶é—´ã€èˆ±ä½ç­‰ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä¸åŒï¼ŒåŠ©æ‰‹æœ€ç»ˆå®Œæˆçš„ä»»åŠ¡ä¸åŒã€‚æ­¤å¤–ï¼Œåœ¨äººä»¬çš„çœŸå®å¯¹è¯ä¸­ï¼Œå°†è¿™äº›ä¿¡æ¯åœ¨ä¸€å¥è¯ä¸­è¯´å‡ºå¹¶ä¸ç¬¦åˆäººä»¬è¯´è¯çš„ä¹ æƒ¯ï¼Œå› æ­¤åŠ©æ‰‹ä¸ç”¨æˆ·ä¹‹é—´å¾€å¾€è¦è¿›è¡Œå¤šè½®å¯¹è¯ã€‚

åœ¨åŠ©æ‰‹åœºæ™¯ä¸­ï¼Œå°½ç®¡ç”¨æˆ·æ˜ç¡®çŸ¥é“å¯¹æ–¹æ˜¯æœºå™¨äººï¼Œä½†å¯¹è¯è¿‡ç¨‹ç›¸æ¯”äºé—®ç­”æ›´åŠ è‡ªç„¶ä¸€äº›ã€‚

#### èŠå¤©

èŠå¤©åœºæ™¯æŒ‡çš„æ˜¯åƒäººä¸€æ ·ä¸äººäº¤è°ˆï¼Œå¸‚é¢ä¸Šå­˜åœ¨çš„ç³»ç»Ÿæœ‰[è´¤äºŒæœºå™¨åƒ§](https://baike.baidu.com/item/%E8%B4%A4%E4%BA%8C%E6%9C%BA%E5%99%A8%E5%83%A7/18694313?fr=aladdin)ã€[å¾®è½¯å°å†°](https://business.xiaoice.com/)ç­‰ã€‚ç†è®ºä¸Šï¼ŒèŠå¤©ä¸å­˜åœ¨å›ºå®šå†…å®¹ï¼Œå¤©å—æµ·åŒ—éƒ½å¯ä»¥ä¾ƒã€‚è‘—åçš„[å›¾çµæµ‹è¯•](https://en.wikipedia.org/wiki/Turing_test)å°±æ˜¯ç”¨äºéªŒè¯æœºå™¨æ˜¯å¦å¯ä»¥è®©äººæ— æ³•åˆ†è¾¨ä»–æ˜¯åœ¨å’ŒäººèŠå¤©è¿˜æ˜¯åœ¨å’Œæœºå™¨èŠå¤©ã€‚

åœ¨èŠå¤©åœºæ™¯ä¸­ï¼Œå¯¹è¯ç³»ç»Ÿé¢å¯¹çš„æŒ‘æˆ˜ä¸å‰äºŒè€…ç›¸æ¯”è¦å¤æ‚å¾ˆå¤šï¼Œå¦‚è‡ªç„¶è¯­è¨€ç†è§£èƒ½åŠ›ã€è®°å¿†èƒ½åŠ›ã€çŸ¥è¯†é¢ï¼Œç”šè‡³è¯­æ°”ã€æ€§æ ¼ç­‰ç­‰ï¼Œä½†å®ƒæä¾›çš„å¯¹è¯ä½“éªŒä¹Ÿæœ€æ¥è¿‘ä¸çœŸäººäº¤è°ˆã€‚

### æ„å»ºæ–¹å¼

#### åŸºäºè§„åˆ™

![](./rule-based.png)

ç®€è€Œè¨€ä¹‹ï¼ŒåŸºäºè§„åˆ™çš„æ„å»ºæ–¹å¼å°±æ˜¯é¢„å…ˆæ ¹æ®é¢†åŸŸçŸ¥è¯†è®¾å®šä¸€äº›è§„åˆ™ï¼Œç”¨æˆ·è¾“å…¥æ–‡æœ¬åï¼Œç³»ç»Ÿæ ¹æ®è§„åˆ™çš„ä¼˜å…ˆçº§é€æ¡æ¯”å¯¹ï¼Œç¬¦åˆè§„åˆ™æ¡ä»¶åï¼Œæ ¹æ®é¢„è®¾çš„æ¨¡æ¿æ‹¼æ¥å‡ºå“åº”ã€‚æˆ‘ä»¬æ¥çœ‹ä¸´åºŠå¿ƒç†æœºå™¨äºº [ELIZA](https://en.wikipedia.org/wiki/ELIZA) (1966) çš„ä¸€æ®µå¯¹è¯ï¼š

```
# U â†’ ç”¨æˆ·ï¼ŒE â†’ ELIZA
...
U: You hate me.
E: What makes you think I hate you?
...
U: I know everybody laughed at me.
E: You say you know everybody laughed at you.
...
```

è¿™é‡Œå®é™…ä¸ŠèƒŒååŒ¹é…äº†ä¸¤æ¡è§„åˆ™ï¼š

1. `(0 You 0 Me) â†’ (What makes you think I 3 You)`
2. `(I *) â†’ (You say you 2)`

å½“å‘è¨€å’Œ left hand side (LHS) åŒ¹é…æ—¶ï¼Œå°±ç”¨ right hand side (RHS) å›å¤ï¼Œå¹¶ä¸”ç”¨å‘è¨€ä¸­å¯¹åº”ä½ç½®çš„å†…å®¹æ›¿æ¢æ‰å›å¤æ¨¡æ¿ä¸­çš„å˜é‡ï¼Œä¸Šè¿°è§„åˆ™ä¸­ RHS çš„æ•°å­—å°±è¡¨ç¤º LHS ä¸­å¯¹åº”çš„ä½ç½® (ä» 1 å¼€å§‹è®¡æ•°)ã€‚å½“ç„¶ï¼Œå®é™…ä¸Š ELIZA èƒŒåçš„é‡‡ç”¨çš„è§„åˆ™å’ŒåŒ¹é…æ–¹å¼æ›´åŠ å¤æ‚ï¼Œå¦‚æœæ„Ÿå…´è¶£å¯ä»¥é˜…è¯»[è®ºæ–‡åŸæ–‡](https://dl.acm.org/doi/10.1145/365153.365168) (cited by 5220)ã€‚

åŸºäºè§„åˆ™çš„æ–¹å¼ä¼˜ç‚¹åŒ…æ‹¬ï¼š

* å¼€å‘é€Ÿåº¦å¿«ã€æˆæœ¬ä½ã€æ˜“é›†æˆ
* è¡Œä¸ºç¨³å®šã€å¯è§£é‡Šï¼Œå®‰å…¨å¯æ§é£é™©å°
* èƒ½å‘é€å¤šåª’ä½“ä¿¡æ¯ã€å›¾ç‰‡ã€è§†é¢‘
* æ¨ç†æ—¶é—´çŸ­ã€é€Ÿåº¦å¿«
* ...

å…¶ç¼ºç‚¹åŒ…æ‹¬ï¼š

* ç»´æŠ¤æˆæœ¬é«˜ï¼Œéœ€è¦äººå·¥ç»´æŠ¤è§„åˆ™å’Œä¼˜å…ˆçº§ï¼Œå¤æ‚åº¦é«˜äº†ä»¥åéš¾ä»¥ç®¡ç†
* ä¸å…·å¤‡è‡ªç„¶è¯­è¨€ç†è§£èƒ½åŠ›ï¼ŒåŒä¹‰è¯­å¥æ— æ³•è§¦ç±»æ—é€šï¼Œéœ€è¦ç©·ä¸¾è§„åˆ™
* æ–°å¢è¯­è¨€æ”¯æŒæˆæœ¬é«˜
* ...

#### åŸºäºè¯­æ–™

![](./corpus-based.png)

åŸºäºè¯­æ–™ï¼Œé¡¾åæ€ä¹‰åœ¨æ„å»ºç³»ç»Ÿä¹‹å‰éœ€è¦å‡†å¤‡å¤§é‡çœŸå®ç¯å¢ƒçš„å¯¹è¯æ•°æ®ï¼Œæ ¹æ®è¿™äº›æ•°æ®è®­ç»ƒå‡ºå¯¹è¯æ¨¡å‹å†æŠ•å…¥ä½¿ç”¨ã€‚åœ¨å¯¹è¯æ—¶ï¼ŒæœåŠ¡ä¼šæŠŠç”¨æˆ·çš„å‘è¨€è¾“å…¥åˆ°é¢„è®­ç»ƒå¥½çš„æ¨¡å‹ä¸­ï¼Œæ¨¡å‹ç»™å‡ºæ¨ç†çš„ç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚è¿™é‡Œçš„æ¨¡å‹å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š

ä¿¡æ¯æ£€ç´¢ï¼šè¿™ç±»æ¨¡å‹ä¼šå°†æ‰€æœ‰å¯¹è¯è½¬åŒ–æˆå¸¸ç”¨çš„è‡ªç„¶è¯­è¨€ç‰¹å¾ï¼Œå¦‚åŸºäºè¯é¢‘çš„ [tf-idf](https://en.wikipedia.org/wiki/Tf%E2%80%93idf) æˆ–åŸºäºè¯­ä¹‰çš„ [embedding](https://en.wikipedia.org/wiki/Word_embedding)ï¼Œç„¶åå°†è¿™äº›ç‰¹å¾å­˜å…¥é€šç”¨æœç´¢å¼•æ“æˆ–å‘é‡æ£€ç´¢å¼•æ“ä¸­ã€‚æ”¶åˆ°ç”¨æˆ·å‘è¨€åï¼Œå…ˆå°†æ–‡æœ¬åšç›¸åŒçš„å‘é‡åŒ–å¤„ç†ï¼Œç„¶åå†é€šè¿‡ä¸Šè¿°å¼•æ“æ£€ç´¢ä¸¾ä¾‹æœ€è¿‘çš„å¯¹è¯ï¼Œå°†å›ç­”è¿”å›ç»™ç”¨æˆ·ã€‚åŸºäºä¿¡æ¯æ£€ç´¢çš„æ¨¡å‹åªèƒ½ç”Ÿæˆè®­ç»ƒæ•°æ®ä¸­å·²çŸ¥çš„å›ç­”ï¼Œç›¸æ¯”åŸºäºè§„åˆ™çš„æ¨¡å‹ï¼Œå®ƒä¸éœ€è¦é€æ¡åœ°ç»´æŠ¤è§„åˆ™ï¼Œè€Œæ˜¯å°†è§„åˆ™é€šè¿‡ç©·ä¸¾çš„æ–¹å¼æ²‰æ·€åœ¨æ•°æ®é›†ä¸­ã€‚

ç»Ÿè®¡æ¨¡å‹ï¼šè¿™ç±»æ¨¡å‹ä¼šå°†æ‰€æœ‰å¯¹è¯è¾“å…¥åˆ°ç»Ÿè®¡æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­ï¼Œå¦‚ [Transformer](https://arxiv.org/abs/1706.03762)ï¼Œé€šè¿‡æœ‰ç›‘ç£è®­ç»ƒå¾—åˆ°è¯­è¨€æ¨¡å‹ï¼Œè¿™ç±»è¯­è¨€æ¨¡å‹å¯ä»¥é€šè¿‡é¢„æµ‹çš„æ–¹å¼ç”Ÿæˆå›ç­”ï¼Œå°½ç®¡è¿™äº›å›ç­”æºè‡ªäºè®­ç»ƒæ•°æ®ï¼Œä½†è¿™äº›å›ç­”å¯èƒ½ä»ä¼—å¤šå¯¹è¯ä¸­åšé‡‡ä¼—é•¿ï¼Œè€Œä¸æ˜¯æ‹©å…¶ä¸€è€Œç”¨ï¼Œå› æ­¤å®ƒçš„å›ç­”ä¸­å¯èƒ½å‡ºç°è®­ç»ƒæ•°æ®ä¸­ä¸å­˜åœ¨çš„è¯­å¥ã€‚

ä¸è®ºæ˜¯ä¿¡æ¯æ£€ç´¢è¿˜æ˜¯æ¨¡å‹ç”Ÿæˆï¼Œåªè¦æ˜¯åŸºäºè¯­æ–™æ„å»ºçš„å¯¹è¯ç³»ç»Ÿéƒ½å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ã€Œgarbage in garbage outã€ï¼Œå¦‚æœè¯­æ–™æœ‰é—®é¢˜ï¼Œå¯¹è¯ç³»ç»Ÿå°±æœ‰é—®é¢˜ã€‚

åŸºäºè¯­æ–™çš„æ–¹å¼ä¼˜ç‚¹åŒ…æ‹¬ï¼š

* ç³»ç»Ÿç»´æŠ¤æˆæœ¬ä½ï¼Œè®­ç»ƒå®Œåæ— éœ€å…¶å®ƒç»´æŠ¤æˆæœ¬
* å…·å¤‡è‡ªç„¶è¯­è¨€ç†è§£èƒ½åŠ›ï¼Œèƒ½è¯†åˆ«åŒä¹‰è¯­å¥çš„ä¸åŒè¡¨è¾¾
* æ–°å¢è¯­è¨€æ”¯æŒæˆæœ¬ä½ï¼Œå› ä¸ºå¼€æºç¤¾åŒºä¸­å·²å­˜åœ¨ä¸åŒè‡ªç„¶è¯­è¨€é¢„è®­ç»ƒå¥½çš„ç‰¹å¾æå–å·¥å…·
* ...

å…¶ç¼ºç‚¹åŒ…æ‹¬ï¼š

* å¼€å‘å‘¨æœŸé•¿ã€æˆæœ¬é«˜ã€éœ€è¦å¤§é‡è®­ç»ƒæ•°æ®
* è®­ç»ƒæ•°æ®é—®é¢˜å¯èƒ½å¯¼è‡´ç³»ç»Ÿè¡Œä¸ºä¸ç¨³å®šï¼Œé£é™©ä¸å¯æ§
* çº¿ä¸Šæ¨¡å‹æ¨ç†æ—¶é—´é•¿ï¼Œå ç”¨èµ„æºå¤š
* ä¸æ”¯æŒå¤šåª’ä½“æ¶ˆæ¯ï¼Œåªèƒ½å‘é€æ–‡æœ¬æˆ–æ–‡æœ¬åˆæˆçš„è¯­éŸ³

#### æ··åˆæ–¹æ¡ˆ

æ··åˆæ–¹æ¡ˆï¼Œå…¶å®å°±æ˜¯å°†åŸºäºè§„åˆ™å’ŒåŸºäºè¯­æ–™çš„æ–¹æ¡ˆèåˆã€‚èåˆçš„æ–¹å¼åƒå˜ä¸‡åŒ–ï¼Œä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯ï¼šä½¿ç”¨ç»Ÿè®¡æ¨¡å‹åšå¥å­ä¸­çš„å†…å®¹æå–ï¼Œå¯¹è¯è¡Œä¸ºè¯†åˆ«ï¼Œä½¿ç”¨è§„åˆ™ç”Ÿæˆå›ç­”ã€‚è¿™ç§åšæ³•æ—¢å¯ä»¥ä¿æŒå¯¹å†…å®¹çš„è¯­ä¹‰çº§åˆ«ç†è§£ï¼Œåˆèƒ½å¤Ÿæ§åˆ¶å›ç­”çš„é£é™©ï¼Œé¿å…ç”Ÿæˆè¡Œä¸ºçš„ä¸ç¨³å®šã€‚å…¶ä¼˜ç¼ºç‚¹éœ€è¦å…·ä½“åˆ†æï¼Œç†æƒ³çŠ¶å†µä¸‹æ˜¯èƒ½è¾¾åˆ°å‰ä¸¤ç§æ–¹æ¡ˆçš„å–é•¿è¡¥çŸ­ã€‚

#### å°ç»“

æ„å»ºæ–¹å¼ä¸ä½¿ç”¨åœºæ™¯äºŒè€…å¹¶æ²¡æœ‰ç›´æ¥å…³ç³»ï¼Œæ˜¯ä¸åŒæŠ½è±¡å±‚çº§ä¸Šçš„æ¦‚å¿µï¼Œä»»æ„ä½¿ç”¨åœºæ™¯éƒ½å¯ä»¥ä½¿ç”¨ä»»æ„æ„å»ºæ–¹å¼æ¥å®ç°ã€‚ä½ æ—¢å¯ä»¥ç©·å°½ä¸–ä¸Šæ‰€æœ‰å¯¹è¯ï¼Œå°†å®ƒä»¬è½¬åŒ–æˆè§„åˆ™ï¼Œç”¨åŸºäºè§„åˆ™çš„æ–¹å¼æ„å»ºèŠå¤©æœºå™¨äººï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŸºäºè¯­æ–™çš„æ–¹å¼å°†çŸ¥è¯†åº“è¾“å…¥åˆ°ç»Ÿè®¡æ¨¡å‹ä¸­å¾—åˆ°å®¢æœæœºå™¨äººã€‚ä½†æ— è®ºä½¿ç”¨å“ªç§æ–¹æ¡ˆï¼Œé¢å¯¹éš¾åº¦è¶Šå¤§çš„åœºæ™¯ï¼ŒæŠ•å…¥çš„èµ„æºè¶Šå¤šï¼Œé‡åˆ°çš„æŒ‘æˆ˜è¶Šå¤šï¼Œæ–¹æ¡ˆçš„å¤æ‚æ€§è¶Šå¤§ã€‚å¤æ‚åœºæ™¯çš„è§£å†³æ–¹æ¡ˆåŒæ ·èƒ½ç”¨äºç®€å•åœºæ™¯ï¼Œæ¯”å¦‚ä¸€ä¸ªé¢å‘åŠ©æ‰‹åœºæ™¯çš„å¯¹è¯ç³»ç»Ÿï¼Œé€šå¸¸ä¹Ÿèƒ½é€‚ç”¨äºé—®ç­”åœºæ™¯ï¼Œåªä¸è¿‡æ˜¯ã€Œå‰²é¸¡ç”¨ç‰›åˆ€ã€è€Œå·²ã€‚

## å¯¹è¯ç³»ç»Ÿ

> âš ï¸ åœ¨ä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¼šå°†è®¨è®ºèŒƒå›´ç¼©å°åˆ°**ä½¿ç”¨æ··åˆæ–¹æ¡ˆæ„å»ºçš„ã€ç”¨äºåŠ©æ‰‹åœºæ™¯çš„å¯¹è¯ç³»ç»Ÿ**ï¼Œæˆ‘ä»¬åŒæ ·å°†ä¹‹ç§°ä¸ºå¯¹è¯ç³»ç»Ÿã€‚è¿™é‡Œè™½ç„¶æœ‰ä¸€ç‚¹åè¯æ»¥ç”¨ï¼Œä½†æ˜¯ä¸ºäº†è¡Œæ–‡æ›´æµç•…ï¼Œæš‚ä¸”è¿™æ ·å¤„ç†ã€‚

### åŸºæœ¬æ¦‚å¿µ

#### é¢†åŸŸ (Domain)

é€šå¸¸å¯¹è¯ç³»ç»Ÿåªè§£å†³æŸä¸ªå…·ä½“é¢†åŸŸé—®é¢˜ï¼Œå¦‚ç½‘çº¦è½¦å®¢æœã€æ–°ç”Ÿå…¥å­¦åŠ©æ‰‹ã€è¯­éŸ³åŠ©æ‰‹ç­‰ç­‰ã€‚ä¸åŒé¢†åŸŸå¯èƒ½æ‹¥æœ‰å„è‡ªçš„æ¦‚å¿µã€å¯¹è¯ç‰¹ç‚¹ã€ç”šè‡³æœºå™¨äººçš„æ€§æ ¼ã€è¯­æ°”ç­‰ç­‰ï¼Œä½†å®ƒä»¬å…±äº«åº•å±‚çš„èƒ½åŠ›ï¼Œæ¯”å¦‚è‡ªç„¶è¯­è¨€ç†è§£ã€å¯¹è¯çŠ¶æ€ç®¡ç†ã€å¯¹è¯ç­–ç•¥ç®¡ç†ã€è‡ªç„¶è¯­è¨€ç”Ÿæˆç­‰ç­‰ã€‚

#### å¯¹è¯ä»£ç†äºº (Agent)

å¯¹è¯ä»£ç†äººæ—¢å¯ä»¥æ˜¯çœŸäººï¼Œå¦‚å®¢æœäººå‘˜ã€å®¢æˆ·æ”¯æŒä»£è¡¨ï¼Œä¹Ÿå¯ä»¥æ˜¯è™šæ‹Ÿäººï¼Œå¦‚æœºå™¨äººã€‚åœ¨å¯¹è¯ç³»ç»Ÿå†…éƒ¨ï¼Œä½ å¯ä»¥ç®€å•åœ°å°†å¯¹è¯ä»£ç†äººç†è§£æˆæœºå™¨äººã€‚æœºå™¨äººå› å…¶è®¾è®¡ç›®çš„ä¸åŒï¼Œæ—¢å¯ç”¨äºè§£å†³å•é¢†åŸŸ (single-domain) é—®é¢˜ï¼Œä¹Ÿå¯ç”¨äºè§£å†³å¤šé¢†åŸŸ (multi-domain) é—®é¢˜ã€‚

#### ä¼šè¯ (Session)

ä¼šè¯æ˜¯å¯¹è¯ä»£ç†äººä¸ç”¨æˆ·ä¹‹é—´å‘ç”Ÿçš„ä¸€æ¬¡è¿ç»­å¯¹è¯ï¼Œä¸åŒå¯¹è¯ç³»ç»Ÿå¯ä»¥æœ‰è‡ªå·±å¯¹ã€Œè¿ç»­ã€çš„å®šä¹‰ã€‚é€šå¸¸ç”¨æˆ·åœ¨å¼€å¯ä¼šè¯æ—¶ä¼šå¸¦ç€æ˜ç¡®çš„ç›®çš„ï¼Œä¼šè¯ç»“æŸæ—¶ï¼Œç›®çš„å³å¯èƒ½è¾¾æˆï¼Œä¹Ÿå¯èƒ½æœªè¾¾æˆï¼Œè€Œæœªè¾¾æˆç›®çš„çš„å¯¹è¯å°±æ˜¯å¯¹è¯è®¾è®¡è€…éœ€è¦é‡ç‚¹å…³æ³¨çš„å†…å®¹ã€‚

#### å‰§æœ¬ (Story)

å‰§æœ¬æ˜¯åœ¨å¯¹è¯è®¾è®¡ä¸­è®¾å®šçš„æ¨¡æ¿ï¼Œæ¯”å¦‚ï¼š

- è¯¢é—®å¤©æ°”
- é¢„å®šè½¦ç¥¨
- å–æ¶ˆè®¢å•
- ä¿®æ”¹åœ°å€
- â€¦

é€šå¸¸ä¸€ä¸ªä¼šè¯å¯¹åº”ä¸€ä¸ªå‰§æœ¬ï¼Œæ¯”è¾ƒçµæ´»çš„å¯¹è¯ç³»ç»Ÿå¯ä»¥æ”¯æŒåœ¨ä¸€ä¸ªä¼šè¯ä¸­é€šè¿‡ä¸Šä¸‹æ–‡åˆ‡æ¢ (context switch) æ¼”ç»å¤šä¸ªå‰§æœ¬ã€‚

æ¯ä¸ªå‰§æœ¬åœ¨æ¼”ç»çš„è¿‡ç¨‹ä¸­éœ€è¦è®°å½•ä¸€äº›ä¾›æœºå™¨äººå†³ç­–ä½¿ç”¨çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯åŒ…æ‹¬ä½†ä¸é™äºï¼š

- åŒæ–¹çš„å¯¹è¯å†å²
- ç³»ç»Ÿå’Œå¤–éƒ¨æ³¨å…¥çš„äº‹ä»¶
- è¡¨å• (form) ä¿¡æ¯
- â€¦

#### å‘è¨€ (Utterance)

åœ¨å¯¹è¯ä¸­ï¼Œæœºå™¨äººä¸ç”¨æˆ·ä»»ä½•ä¸€æ–¹è¯´å‡ºçš„ä»»æ„ä¸€å¥è¯ã€‚

#### å¯¹è¯ç­–ç•¥ (Dialogue policy)

åœ¨æ”¶åˆ°ç”¨æˆ·çš„å‘è¨€ä¹‹åï¼Œæœºå™¨äººè¦å†³å®šå›å¤ä»€ä¹ˆå†…å®¹ï¼Œè¿™ä¸ªå†³å®šçš„æ ¹æ®å°±æ˜¯ç³»ç»Ÿä¸­è®¾å®šçš„å¯¹è¯ç­–ç•¥ã€‚å‰§æœ¬æ˜¯å¯¹è¯ç­–ç•¥çš„ä¸€ç§ï¼Œä¸€ä¸ªå¤æ‚çš„å¯¹è¯ç³»ç»Ÿè¿˜å¯èƒ½åŒ…å«å…¶å®ƒç±»å‹çš„å¯¹è¯ç­–ç•¥ã€‚

#### æ„å›¾ (Intent)

æ„å›¾æ˜¯ç³»ç»Ÿèƒ½å¤Ÿè¯†åˆ«çš„æœ€å°çš„ç”¨æˆ·ç›®çš„ï¼Œæ˜¯ç³»ç»Ÿå†³ç­–çš„åŸºæœ¬å…ƒç´ ä¹‹ä¸€ã€‚åªæœ‰åœ¨è¯†åˆ«ç”¨æˆ·å‘è¨€èƒŒåçš„å«ä¹‰åï¼Œæœºå™¨äººæ‰èƒ½å†³å®šå›å¤ä»€ä¹ˆã€‚å‰§æœ¬ä¸­çš„æ¯ä¸€ç« èŠ‚ç”±ç”¨æˆ·æ„å›¾çš„è¯†åˆ«å’Œæœºå™¨äººé‡‡ç”¨çš„å›ç­”æ„æˆã€‚ä»å‘è¨€çš„è§’åº¦å‡ºå‘ï¼Œæ„å›¾çº¦ç­‰ä»·äºå‘è¨€ä¸­çš„åŠ¨è¯ã€‚å¦‚ã€Œä¸‹å‘¨æˆ‘è¦é£å»ä¸Šæµ·ã€ä¸­çš„ã€Œé£ã€å°±æ˜¯æ„å›¾ã€‚

#### å®ä½“ (Entity)

å®ä½“å¯ä»¥è®¤ä¸ºæ˜¯å‘è¨€ä¸­çš„åè¯ï¼Œå¦‚ã€Œæˆ‘æƒ³è®¢ 7 æœˆ 20 æ—¥ä»åŒ—äº¬é£åˆ°äº‘å—çš„æœºç¥¨ã€ä¸­çš„ã€Œ7 æœˆ 20 æ—¥ã€ã€ã€ŒåŒ—äº¬ã€ã€ã€Œäº‘å—ã€å’Œã€Œæœºç¥¨ã€å¯¹åº”ç€æ—¶é—´ã€å‡ºå‘åœ°ã€ç›®çš„åœ°å’Œç¥¨æ®ï¼Œå››è€…éƒ½æ˜¯å®ä½“ã€‚æœ‰äº›å®ä½“å’Œé¢†åŸŸæ¯æ¯ç›¸å…³ï¼Œå¦‚ç¥¨æ®è¿™æ ·çš„å®ä½“å‡ ä¹ä¸ä¼šå‡ºç°åœ¨ç‚¹é¤æœºå™¨äººç³»ç»Ÿä¸­ï¼›æœ‰äº›å®ä½“åˆ™æ¯”è¾ƒé€šç”¨ï¼Œæ¯”å¦‚æ—¶é—´ã€åœ°ç‚¹ã€æ•°å­—ç­‰ç­‰ã€‚å’Œé¢†åŸŸç›¸å…³çš„å®ä½“éœ€è¦å•ç‹¬å®šä¹‰ï¼Œé€šç”¨å®ä½“åˆ™å¯ä»¥ç”±å¹³å°ç»Ÿä¸€æ”¯æŒã€‚

#### æ§½ä½ (Slot)

åœ¨å‰§æœ¬çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬æåˆ°è¿‡è¡¨å•ï¼Œåè€…è®°å½•ç€ä¸å†³ç­–æœ‰å…³çš„æ•°æ®ï¼Œå¦‚è´­ä¹°æœºç¥¨æ‰€éœ€çš„ã€Œå‡ºå‘åœ°ã€ã€ã€Œç›®çš„åœ°ã€ã€ã€Œæ—¶é—´ã€ç­‰ä¿¡æ¯ã€‚æˆ‘ä»¬ç§°ç››æ”¾è¿™äº›ä¿¡æ¯çš„å®¹å™¨ä¸ºæ§½ä½ï¼Œä¿¡æ¯æœ¬èº«ä¸ºæ§½ä½å¡«å……ç‰© (slot filler)ã€‚æƒ³è±¡å»æ‰“ç–«è‹—æ—¶å¡«å†™çš„è¡¨æ ¼ï¼Œè¡¨ä¸­çš„æ¯ä¸ªç©ºå°±æ˜¯æ§½ä½ï¼Œä½ å¡«å†™çš„å†…å®¹å°±æ˜¯æ§½ä½å¡«å……ç‰©ã€‚

> ğŸ™‹ğŸ» æ§½ä½å’Œå®ä½“çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
>
> å®ä½“æŒ‡çš„æ˜¯ä»å•å¥å‘è¨€ä¸­æå–åˆ°çš„ä¿¡æ¯ï¼Œè€Œæ§½ä½å­˜å‚¨æ•´ä¸ªä¼šè¯è¿‡ç¨‹ä¸­æå–åˆ°çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå‰è€…æ˜¯åè€…çš„æ•°æ®æ¥æºï¼Œæ§½ä½å­˜å‚¨çš„ä¿¡æ¯ä¼šè¢«ç”¨äºåç»­å¯¹è¯ç³»ç»Ÿå†³ç­–çš„è¿‡ç¨‹ä¸­ã€‚

#### åŠ¨ä½œ (Action)

ç†è§£ç”¨æˆ·çš„æ„å›¾åï¼Œå¯¹è¯ä»£ç†äººé™¤äº†å›å¤æ¶ˆæ¯å¤–ï¼Œå¯èƒ½éœ€è¦å¸®åŠ©ç”¨æˆ·å»åšä¸€äº›åŠ¨ä½œï¼Œæ¯”å¦‚ï¼š

- ä¿®æ”¹æ—¥ç¨‹
- æ³¨é”€è´¦å·
- ä¿®æ”¹å¥—é¤
- æŸ¥è¯¢å¤©æ°”
- â€¦

ä¸åŒé¢†åŸŸçš„å¯¹è¯ä»£ç†äººéœ€è¦æ‰§è¡Œçš„åŠ¨ä½œä¸åŒï¼Œéœ€è¦å®šåˆ¶åŒ–å¼€å‘ã€‚åœ¨è®¾è®¡ä¸­ï¼Œæœºå™¨äººå›å¤æ¶ˆæ¯é€šå¸¸ä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ç§åŠ¨ä½œã€‚ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š

```yaml
story:
  steps:
    - intent: arrange_meeting
    - action: update_calendar
    - action: utter_arrange_meeting
```

ä¸Šé¢è¿™ä¸ªå‰§æœ¬è¯´çš„å°±æ˜¯ï¼šæœºå™¨äººåœ¨è¯†åˆ«ç”¨æˆ·å‘è¨€ä¸­çš„æ„å›¾æ˜¯ä¸¾åŠä¼šè®® (arrange_meeting) æ—¶ï¼Œå…ˆæ‰§è¡Œæ›´æ–°æ—¥å† (update_calendar) çš„åŠ¨ä½œï¼Œå†æ‰§è¡Œå›å¤ç”¨æˆ· (utter_arrange_meeting) çš„åŠ¨ä½œã€‚

#### å¯¹æ¥æ¸ é“ (Channel)

å¯¹è¯ä»£ç†äººæœ¬èº«åªè´Ÿè´£å¯¹è¯é€»è¾‘ï¼Œå¹¶ä¸åŒ…å«å¯¹è¯è½½ä½“ï¼Œå¦‚é’‰é’‰ã€ç¾æ´½ã€é£ä¹¦ã€Slack ç­‰ç­‰ï¼Œåé¢åˆ—ä¸¾çš„è¿™äº›è½½ä½“å°±æ˜¯å¯¹æ¥æ¸ é“ã€‚

### ä¸€èˆ¬æ¶æ„

å¯¹è¯ç³»ç»Ÿçš„ä¸€èˆ¬æ¶æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

![](./general-architecture.png)

#### Automatic Speech Recognition (ASR)

ASR æ¨¡å—è´Ÿè´£å°†ç”¨æˆ·è¾“å…¥çš„**éŸ³é¢‘è½¬åŒ–ä¸ºæ–‡æœ¬**ï¼Œå¾—åˆ°ç”¨æˆ·å‘è¨€çš„æ–‡æœ¬ã€‚è¿™ä¸ªæ¨¡å—æ—¢å¯ä»¥é‡‡ç”¨é€šç”¨å‹ ASR æœåŠ¡ï¼Œä¹Ÿå¯ä»¥åœ¨é¢†åŸŸå†…é€šè¿‡è¿ç§»å­¦ä¹ å®šåˆ¶åŒ–å¼€å‘ã€‚ASR çš„è¯†åˆ«å‡†ç¡®åº¦å°†å¯¹åç»­æ‰€æœ‰æ¨¡å—çš„å¤„ç†äº§ç”Ÿæ·±è¿œçš„å½±å“ï¼Œå°±å¥½æ¯”åœ¨ä¼ è¯æ¸¸æˆä¸­ï¼Œè¶Šé å‰çš„è¡¨è¿°é”™è¯¯ä¼šè¢«æ”¾å¾—è¶Šå¤§ã€‚

> âš ï¸ å¦‚æœå¯¹è¯ç³»ç»Ÿä»…éœ€æ”¯æŒæ–‡æœ¬å¯¹è¯åˆ™æ— éœ€ ASR æ¨¡å—ï¼Œå› æ­¤åœ¨æ¶æ„å›¾ä¸­ç”¨è™šçº¿è¡¨ç¤º

#### Natural Language Understanding (NLU)

NLU æ¨¡å—è´Ÿè´£ä»ç”¨æˆ·çš„å‘è¨€ä¸­è§£æå‡ºå¯¹è¯ä¸­åŒ…å«çš„å…³é”®ä¿¡æ¯ï¼Œå¦‚é¢†åŸŸã€æ„å›¾ã€å®ä½“ç­‰ç­‰ã€‚åœ¨æ—©æœŸçš„å¯¹è¯ç³»ç»Ÿä¸­ï¼Œä¸»è¦ä¾é åŸºäºè§„åˆ™åŒ¹é…çš„æ–¹å¼æå–ä¿¡æ¯ï¼Œè€Œç°ä»£å¯¹è¯ç³»ç»Ÿåˆ™ä¸»è¦é‡‡ç”¨ç»Ÿè®¡æœºå™¨å­¦ä¹ æ¨¡å‹ï¼ŒåŸºäºå¤§é‡è¯­æ–™è®­ç»ƒå¾—åˆ°ã€‚ç”¨äºé¢†åŸŸã€æ„å›¾è¯†åˆ«å’Œå®ä½“æå–çš„æ¨¡å‹é€šå¸¸ä¼šå…±äº«æ–‡æœ¬ç‰¹å¾ï¼Œåœ¨é¢„æµ‹æ¨¡å—ä¸­åŒºåˆ†ã€‚å½“ç„¶ï¼Œä¹Ÿå­˜åœ¨æ··åˆè§£å†³æ–¹æ¡ˆçš„ NLUï¼Œå¦‚åŒæ—¶æ”¯æŒåŸºäºè§„åˆ™å’ŒåŸºäºè¯­æ–™çš„å®ä½“æå–ã€‚

NLU æ¨¡å—æœ‰æ—¶ä¹Ÿä¼šè¢«ç”¨äºä»ç²—ç­›åçš„å¤‡é€‰ç­”æ¡ˆä¸­åšç²¾ç­›ï¼Œæ¯”å¦‚æ ¹æ®å‘è¨€ä¸è¯­æ–™ä¸­å¤‡é€‰å›å¤çš„ç‰¹å¾è·ç¦»æ¥åšå‡ºæœ€ç»ˆé€‰æ‹©ã€‚

#### Dialogue Management (DM)

DM æ¨¡å—è´Ÿè´£ç®¡ç†å½“å‰å¯¹è¯çš„çŠ¶æ€ (State) å’Œç­–ç•¥ (Policy)ï¼Œå…¶ä¸­å¯¹è¯çŠ¶æ€åŒ…æ‹¬ç”¨æˆ·ä¸å¯¹è¯ä»£ç†äººä¹‹é—´çš„å†å²èŠå¤©è®°å½•ä»¥åŠå…³é”®ä¿¡æ¯ï¼Œç­–ç•¥æ˜¯æ ¹æ®çŠ¶æ€è¾“å‡ºå›å¤çš„å‡½æ•°ã€‚

#### Natural Language Generation (NLG)

å½“å¯¹è¯ä»£ç†äººåšå®Œå†³å®šåï¼Œéœ€è¦æŠŠå®ƒæƒ³å›å¤çš„å†…å®¹è½¬åŒ–æˆè‡ªç„¶è¯­è¨€ï¼Œè¿™ä¸€æ­¥éª¤å°±ç”± NLG æ¨¡å—è´Ÿè´£å®Œæˆã€‚NLG æœ‰ä¸¤ç§æ–¹æ¡ˆï¼šåŸºäºæ¨¡æ¿å’ŒåŸºäºç»Ÿè®¡ã€‚

##### åŸºäºæ¨¡æ¿

åŸºäºæ¨¡æ¿çš„ç”Ÿæˆæ–¹æ¡ˆä¸­ï¼Œå¯¹è¯ä»£ç†äººçš„æ‰€æœ‰å‘è¨€éƒ½ç”±å¯¹è¯è®¾è®¡å¸ˆè®¾è®¡è€Œæˆï¼Œç„¶åå°†å‰§æœ¬ä¸­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¦‚æ§½ä½å¡«å……ç‰©ï¼Œå¡«å…¥æ¨¡æ¿ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š

```go
const template = "What time do you want to leave %s"
const slotCityOrig = "Beijing"
const uterrance = fmt.Sprintf(template, slotCityOrig)
```

é€šå¸¸ä¸ºäº†è®©å›å¤ä¸é‚£ä¹ˆå‘†æ¿ï¼Œä¼šä¸ºåŒä¸€ä¸ªå›ç­”é¢„ç½®å¤šä¸ªæ¨¡æ¿ï¼Œç„¶ååœ¨å›å¤æ—¶é€šè¿‡ä¸€äº›ç­–ç•¥é€‰å–ä¸€ä¸ªã€‚

##### åŸºäºç»Ÿè®¡

åŸºäºç»Ÿè®¡ç”Ÿæˆçš„ç›®æ ‡å°±æ˜¯åœ¨å¤§é‡æ ‡æ³¨è¯­æ–™è®­ç»ƒåï¼Œèƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆå«ä¹‰ç›¸åŒã€è¡¨è¿°ä¸åŒçš„å‘è¨€ï¼Œå¦‚ï¼š

```
1. Au Midi is in Midtown and serves French food.
2. There is a French restaurant in Midtown called Au Midi.
```

åŸºäºç»Ÿè®¡çš„ç”Ÿæˆæ–¹æ¡ˆéœ€è¦å¤§é‡çš„è®­ç»ƒæ•°æ®ï¼Œè¿™äº›æ•°æ®æœ¬èº«å¾ˆéš¾è·å–ï¼Œéš¾åº¦ä½“ç°åœ¨ä¸¤æ–¹é¢ï¼š

1. åœ¨æŸé¢†åŸŸçš„å¯¹è¯ä»£ç†äººä¸Šçº¿ä¹‹å‰ï¼Œå¾ˆéš¾è·å¾—å’Œç”Ÿäº§ç¯å¢ƒç›¸è¿‘çš„æ•°æ®
2. ä»¥ä¸Šé¢çš„å¥å­ä¸ºä¾‹ï¼Œå¦‚æœè¦è®­ç»ƒä¸€ä¸ªç‚¹é¤æœºå™¨äººï¼Œé‚£ä¹ˆè¦æ‰¾åˆ°åŒ…å«æ‰€æœ‰é¥­åº—ã€åœ°ç‚¹å’Œèœè‰²ç»„åˆçš„è¯­æ–™å‡ ä¹ä¸å¯èƒ½

å› æ­¤æœ‰ä¸€ç§æ¯”è¾ƒå¸¸ç”¨çš„æŠ€æœ¯å« delexicalizationï¼Œå³å°†å¥å­ä¸­çš„å®ä½“æ›¿æ¢æˆå®ä½“ç±»å‹ï¼Œå¦‚ï¼š

```
1. $restaurant_name is in $neighborhood and serves $cuisine food.
2. There is a $cuisine restaurant in $neighborhood called $restaurant_name.
```

åœ¨è®­ç»ƒæ—¶ä½¿ç”¨å®ä½“ç±»å‹ï¼Œé¢„æµ‹æ—¶å°†å®ä½“çœŸå®å–å€¼å¡«å…¥å³å¯ï¼Œåè€…è¢«ç§°ä¸º relexicalizeã€‚

#### Text To Speech (TTS)

TTS æ¨¡å—è´Ÿè´£å°†å¯¹è¯ä»£ç†äººçš„å›å¤å‘è¨€è½¬åŒ–æˆè¯­éŸ³ã€‚

> âš ï¸ å¦‚æœå¯¹è¯ç³»ç»Ÿä»…éœ€æ”¯æŒæ–‡æœ¬å¯¹è¯åˆ™æ— éœ€ TTS æ¨¡å—ï¼Œå› æ­¤åœ¨æ¶æ„å›¾ä¸­ç”¨è™šçº¿è¡¨ç¤º

## æ¡ˆä¾‹åˆ†æï¼šRasa

Rasa ä¸ä»…æ˜¯ä¸€ä¸ªå¼€æºå¯¹è¯ç³»ç»Ÿçš„åå­—ï¼Œä¹Ÿæ˜¯å…¶èƒŒåçš„[åˆ›ä¸šå…¬å¸](https://www.crunchbase.com/organization/rasa)åç§°ã€‚æˆªæ­¢åˆ°è°ƒç ”ç»“æŸï¼Œè¯¥å…¬å¸å·²ç»æ‹¥æœ‰ 221 äººçš„[åˆ›ä¸šå›¢é˜Ÿ](https://rasa.com/about/)ï¼Œå…¶ä¸­[ç®—æ³•å›¢é˜Ÿ](https://rasa.com/research/) 12 äººï¼Œå·¥ç¨‹å¸ˆ 33 äººï¼Œä½¿ç”¨å®ƒå°±ç›¸å½“äºæ‹¥æœ‰ 221 äººåœ¨èƒŒåå¸®å¿™åšäº§å“ã€å·¥ç¨‹ã€ç®—æ³•çš„ä¼˜åŒ–ã€‚æ­¤å¤–ï¼ŒRasa çš„[æŠ€æœ¯åšå®¢](https://blog.rasa.com/)ä¹Ÿç›¸å½“æ´»è·ƒï¼Œæœ€è¿‘æ›´æ–°çš„æ–‡ç« ä¹Ÿå‘å¸ƒäº 2021 å¹´ 7 æœˆã€‚

Rasa æ——ä¸‹æœ‰ä¸¤ä¸ªæ ¸å¿ƒäº§å“ï¼šRasa OpenSource å’Œ Rasa Xã€‚Rasa OpenSourceï¼Œé¡¾åæ€ä¹‰æ˜¯å¼€æºè½¯ä»¶ï¼Œå®ƒæä¾›çš„å¼€å‘æ¡†æ¶å¯æ”¯æŒå¼€å‘è€…çµæ´»å®šåˆ¶å¯¹è¯ç³»ç»Ÿï¼Œ[æˆæƒåè®®](https://github.com/RasaHQ/rasa#license)ä¸º Apache 2.0ï¼›è€Œ Rasa X ä¸ºé—­æºé¡¹ç›®ï¼Œæ˜¯åŸºäº Rasa OpenSource ä¹‹ä¸Šæä¾›çš„ä¸€äº›ä¼˜åŒ–æ„å»ºå·¥ä½œæµçš„æœ‰é¡µé¢äº¤äº’çš„å¤–å›´æœåŠ¡ï¼Œå¦‚å¼€å‘è°ƒè¯•ã€åˆ†äº«è¯•ç”¨ã€æ¨¡å‹ç®¡ç†ã€å¯¹è¯æ•°æ®ç®¡ç†ç­‰ç­‰ã€‚è™½ç„¶ä»£ç ä¸å¼€æºï¼Œä½† Rasa X çš„ç¼–è¯‘äº§ç‰©å·²å¼€æ”¾ä½¿ç”¨ï¼Œæˆæƒåè®®ä¸º [Rasa X Community Edition License](https://storage.googleapis.com/rasa-x-releases/rasa_x_ce_license_agreement.pdf)ï¼Œå¤§æ„å°±æ˜¯ä¸å¯åŸºäºæ­¤æä¾› SaaS æœåŠ¡ã€‚ä¸€è¨€ä»¥è”½ä¹‹ï¼Œæ²¡æœ‰ Rasa Xï¼Œå¼€å‘è€…ä¹Ÿèƒ½åˆ©ç”¨ Rasa OpenSource æ„å»ºå¯¹è¯ç³»ç»Ÿï¼Œæœ‰äº† Rasa Xï¼Œå¼€å‘è€…å¯ä»¥æ›´é«˜æ•ˆåœ°æ„å»ºå¯¹è¯ç³»ç»Ÿã€‚æœ¬æ–‡åªè®¨è®ºä¸å¯¹è¯ç³»ç»Ÿæ ¸å¿ƒé€»è¾‘ç›¸å…³çš„ Rasa OpenSourceã€‚

### ç³»ç»Ÿæ¶æ„ (Rasa OpenSource)

> â„¹ï¸ æœ¬èŠ‚å†…å®¹æºè‡ªè¿™ç¯‡[æ–‡æ¡£](https://rasa.com/docs/rasa/arch-overview/)

![](./rasa-architecture.png)

å„ä¸ªæ¨¡å—çš„è¯´æ˜ç½—åˆ—å¦‚ä¸‹ï¼š

* NLU Pipelineï¼šç”¨äºæ„å›¾è¯†åˆ«ã€å®ä½“æå–ã€å“åº”æ£€ç´¢ï¼Œå…·ä½“åŸç†å¯ä»¥é˜…è¯»[è¿™ç¯‡åšå®¢](https://blog.rasa.com/intents-entities-understanding-the-rasa-nlu-pipeline/)ï¼Œä»¥åŠè§‚çœ‹[è¿™ç»„è§†é¢‘](https://www.youtube.com/playlist?list=PL75e0qA87dlG-za8eLI6t0_Pbxafk-cxb)
* Dialogue Policiesï¼šç”¨äºç®¡ç†å¯¹è¯ç­–ç•¥ï¼Œå…·ä½“åŸç†å¯ä»¥é˜…è¯»[è¿™ç¯‡åšå®¢](https://blog.rasa.com/dialogue-policies-rasa-2/)
* Tracker Storesï¼šè´Ÿè´£å¯¹è¯æ•°æ®çš„è¯»å†™ï¼Œæ”¯æŒä½¿ç”¨ä¸åŒçš„å­˜å‚¨å¼•æ“
* Lock Storesï¼šé€šè¿‡æŠ¢é”æ¥ç¡®å®šå•ä¸ªå¯¹è¯ä¸­å‘è¨€çš„é¡ºåºï¼Œä»è€Œæ”¯æŒå¯¹è¯ç³»ç»Ÿçš„æ¨ªå‘å¯æ‰©å±•æ€§
* Model Storageï¼šæ”¯æŒä»æœ¬åœ°ç£ç›˜ã€HTTP æœåŠ¡ä»¥åŠå¯¹è±¡å­˜å‚¨è·å–è®­ç»ƒå¥½çš„æ¨¡å‹
* Action Serverï¼šæ—¢å¯ä»¥ç”¨äºå¸®åŠ©æœºå™¨äººå¯¹æ¥ä¸‰æ–¹æœåŠ¡ï¼Œæ‰§è¡Œç”¨æˆ·æœŸæœ›çš„ä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥ç”¨äºæ›´çµæ´»åœ°æ§åˆ¶å¯¹è¯é€»è¾‘
* Event Brokersï¼šå¯ä»¥å°†å¯¹è¯è¿‡ç¨‹ä¸­å‘ç”Ÿçš„äº‹æƒ…å¼‚æ­¥é€šçŸ¥ç»™ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œä¸å¤–éƒ¨æœåŠ¡åˆ†äº«å¯¹è¯æ•°æ®

### å¯¹è¯è¿‡ç¨‹

> â„¹ï¸ æœ¬èŠ‚å†…å®¹æºè‡ªè¿™ç¯‡[è®ºæ–‡](https://arxiv.org/pdf/1712.05181.pdf)

![](./from-input-to-output.png)

1. ç”¨æˆ·å‘é€æ¶ˆæ¯ç»™æœåŠ¡ï¼Œå…ˆè¿›å…¥ interpreterï¼Œåè€…åˆ©ç”¨ NLU ä»æ–‡æœ¬ä¸­æå–æ„å›¾ç­‰ç»“æ„åŒ–ä¿¡æ¯
2. Tracker æ‹¿åˆ°æ¶ˆæ¯æœ¬èº«ä»¥åŠ NLU åˆ†æåçš„ç»“æœï¼Œå°†å¿…è¦çš„ä¿¡æ¯æŒä¹…åŒ–åˆ°å­˜å‚¨å¼•æ“ä¸­
3. Policy ä» Tracker ä¸­æ‹¿åˆ°å½“å‰çŠ¶æ€
4. Policy æ ¹æ®å½“å‰çŠ¶æ€å’Œå†å²å¯¹è¯æ•°æ®ä»¥åŠé¢„å…ˆè®¾ç½®å¥½çš„å¯¹è¯ç­–ç•¥ï¼Œå†³å®šä¸‹ä¸€æ­¥åŠ¨ä½œ
5. é€‰ä¸­åŠ¨ä½œåï¼Œè®°å½•ä¸€æ¡åŠ¨ä½œæ—¥å¿—åˆ° Tracker ä¸­
6. æ‰§è¡ŒåŠ¨ä½œï¼Œè¿™ä¸ªåŠ¨ä½œå¯èƒ½æ˜¯å‘é€å“åº”æ•°æ®ç»™ç”¨æˆ·ï¼Œå¯èƒ½æ˜¯è¯·æ±‚ Action Server è°ƒç”¨ç¬¬ä¸‰æ–¹æœåŠ¡æ¥å£ï¼Œä¹Ÿå¯èƒ½æ˜¯é˜»å¡ç­‰å¾…ç”¨æˆ·è¾“å…¥
7. å¦‚æœå¾…æ‰§è¡Œçš„åŠ¨ä½œä¸æ˜¯ "listen"ï¼Œå³é˜»å¡ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œåˆ™å›åˆ°æ­¥éª¤ 3

### å†³ç­–è¿‡ç¨‹

> â„¹ï¸ æœ¬èŠ‚å†…å®¹æºè‡ªè¿™ç¯‡[åšå®¢](https://blog.rasa.com/dialogue-policies-rasa-2/)ï¼Œæƒ³è¯¦ç»†äº†è§£å¯é˜…è¯»å…¨æ–‡

Rasa OpenSource æä¾›ä¸‰ç§å›å¤ç­–ç•¥ï¼š

* RulePolicyï¼šåŸºäºè§„åˆ™çš„ç­–ç•¥ï¼Œä½†è¿™ä¸ªè§„åˆ™å…·å¤‡ NLU ç†è§£èƒ½åŠ›ï¼Œè¿™ç§ç­–ç•¥é€šå¸¸æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼Œåªè´Ÿè´£å•è½®å¯¹è¯
* MemoizationPolicyï¼šåŸºäºå‰§æœ¬çš„ç­–ç•¥ï¼Œæ ¹æ®é¢„å…ˆå†™å¥½çš„å‰§æœ¬ï¼Œé€æ­¥æ¨è¿›å¯¹è¯ã€‚å‰§æœ¬ä¹‹é—´æ— æ³•åˆ‡æ¢ï¼Œå¸¸ç”¨äºåŠ©æ‰‹åœºæ™¯
* TEDPolicyï¼šæ ¹æ®æä¾›çš„å‰§æœ¬æ•°æ®æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªè¡Œä¸ºï¼Œå…·å¤‡å‰§æœ¬æ³›åŒ–èƒ½åŠ›ï¼Œä½¿å¾—å¯¹è¯ç³»ç»Ÿæ›´åŠ æ™ºèƒ½

ä¸‰ç§ç­–ç•¥çš„ä¼˜å…ˆçº§ä¾æ¬¡é€’å‡ï¼Œå†³ç­–è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](./policy.png)

### å…¶å®ƒå¯¹è¯ç³»ç»Ÿ

é™¤ Rasa ä¹‹å¤–ï¼Œå¸‚é¢ä¸Šä¹Ÿå­˜åœ¨ä¸€äº›æŠ½è±¡å±‚çº§æ›´é«˜ï¼Œé¢å‘éç ”å‘äººå‘˜çš„å¯¹è¯ç³»ç»Ÿæ„å»ºå¹³å°ï¼Œå¦‚ Google çš„ [DialogueFlow](https://cloud.google.com/dialogflow)ã€AWS çš„ [Lex](https://aws.amazon.com/cn/lex/)ã€Microsoft çš„ [Bot Framework](https://www.botframework.com/)ã€ç™¾åº¦çš„ [UNIT](https://ai.baidu.com/unit/home) ä»¥åŠé˜¿é‡Œçš„[äº‘å°èœœ](https://helpcdn.aliyun.com/product/59495.html)ç­‰ç­‰ï¼Œè¿™äº›å¹³å°éƒ½æ˜¯é—­æºç³»ç»Ÿï¼Œèƒ½è·å–çš„æ–‡æ¡£ä¸»è¦ä»¥å¦‚ä½•ä½¿ç”¨ä¸ºä¸»ï¼Œå› æ­¤ä¸å±äºæœ¬æ–‡çš„æ¢ç´¢é‡ç‚¹ã€‚ä½†ä»äº§å“è§’åº¦å‡ºå‘ï¼Œå®ƒä»¬ä¾ç„¶æœ‰å¾ˆé«˜çš„è°ƒç ”ä»·å€¼ã€‚

## åè®°

å®Œæˆæœ¬ç¯‡æ–‡ç« ï¼Œç®—æ˜¯å¯¹è¿™æ®µæ—¶é—´è°ƒç ”çš„ä¸€ä¸ªäº¤ä»£ã€‚åç»­æˆ‘ä»¬å°†ç»§ç»­æ¢ç´¢å¯¹è¯ç³»ç»Ÿçš„å®è·µï¼Œä»¥æœŸåœ¨å¯¹è¯è®¾è®¡ã€æ„å»ºï¼Œä»¥åŠæ™ºèƒ½åŒ–é¡¹ç›®ä¸­å·¥ç¨‹å›¢é˜Ÿä¸ç®—æ³•å›¢é˜Ÿåˆä½œç­‰æ–¹é¢è·å¾—æ›´å¤šçš„ç»éªŒå’Œæ´è§ã€‚

## å‚è€ƒæ–‡çŒ®

* [Speech and Language Processing - Chapter 24: Chatbots & Dialogue Systems](https://web.stanford.edu/~jurafsky/slp3/24.pdf)
* Rasaï¼š
  * [docs](https://rasa.com/docs/)
  * [github organization](https://github.com/RasaHQ)
  * [blogs](https://blog.rasa.com/)
    * [Intents & Entities: Understanding the Rasa NLU Pipeline](https://blog.rasa.com/intents-entities-understanding-the-rasa-nlu-pipeline/)
    * [Zooming in on Dialogue Management in Rasa 2.0](https://blog.rasa.com/dialogue-policies-rasa-2/)
    * [Introducing DIET: state-of-the-art architecture that outperforms fine-tuning BERT and is 6X faster to train](https://blog.rasa.com/introducing-dual-intent-and-entity-transformer-diet-state-of-the-art-performance-on-a-lightweight-architecture/)
    * [Conversational AI: Your Guide to Five Levels of AI Assistants in Enterprise](https://blog.rasa.com/conversational-ai-your-guide-to-five-levels-of-ai-assistants-in-enterprise/)
  * Youtube
    * [Algorithm Whiteboard](https://www.youtube.com/playlist?list=PL75e0qA87dlG-za8eLI6t0_Pbxafk-cxb)
* Wikipedia: [Turing test](https://en.wikipedia.org/wiki/Turing_test), [ELIZA](https://en.wikipedia.org/wiki/ELIZA), [tf-idf](https://en.wikipedia.org/wiki/Tf%E2%80%93idf), [word embedding](https://en.wikipedia.org/wiki/Word_embedding)
* Papers
  * [Attention Is All You Need](https://arxiv.org/abs/1706.03762)
  * [Rasa: Open Source Language Understanding and Dialogue Management](https://arxiv.org/pdf/1712.05181.pdf)
  * [DIET: Lightweight Language Understanding for Dialogue Systems](https://arxiv.org/abs/2004.09936)

