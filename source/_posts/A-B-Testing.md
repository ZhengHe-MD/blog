---
title: ä¸€æ¬¡å®éªŒã€ä¸¤ç§é”™è¯¯ã€ä¸‰ä¸ªç›´è§‰
date: 2022-07-04 19:50:21
tags:
mathjax: true
---

æœ€è¿‘ï¼Œæˆ‘ä»¬åœ¨å…¬å¸å†…éƒ¨åšäº†ä¸€äº› [Hacking Growth](https://www.goodreads.com/book/show/31625067-hacking-growth) æ–¹å‘çš„æ¢ç´¢ï¼Œæˆ‘ä»¬å›¢é˜Ÿä¿¨ç„¶æˆäº†å¢é•¿å›¢é˜Ÿï¼Œä»ç”¨æˆ·å¢é•¿ã€è½¬åŒ–çš„å„ä¸ªç¯èŠ‚ä¸Šå°è¯•ä¸åŒçš„ç­–ç•¥ï¼Œæ‹‰æ–°ã€æ¿€æ´»ã€ç•™å­˜ã€ä¿ƒæ´»ã€å•†ä¸šåŒ–ï¼Œæ•´ä¸ªæ ¸å¿ƒæµç¨‹æ˜¯ä¸€ä¸ªå¤§æ¼æ–—ï¼Œä¸åŒçš„é˜¶æ®µå’Œæ¸ é“åˆå¯ä»¥æ‹†åˆ†æˆä¸åŒçš„å°æ¼æ–—ï¼Œå“ªä¸ªç¯èŠ‚æŸå¤±å¤§å°±ä¼˜åŒ–å“ªä¸ªã€‚ä½†æ— è®ºåšä½•ç§å°è¯•ï¼Œéƒ½ç»•ä¸å¼€ A/B æµ‹è¯•ã€‚

<!--more-->

å¯¹äºä¸€åå·¥ç¨‹å¸ˆï¼Œæˆ‘è®¤ä¸º A/B æµ‹è¯•æœ‰ä¸¤ä¸ªè§’åº¦å€¼å¾—äº†è§£ï¼š

1. å¦‚ä½•æ­å»ºä¸€ä¸ª A/B æµ‹è¯•å¹³å°ï¼Œæ”¯æŒæµé‡åˆ†å±‚ã€è½¬å‘ï¼Œè®©ä¸åŒå®éªŒå…±äº«æµé‡ï¼›

2. å¦‚ä½•åŠ¨æ‰‹åšä¸€ä¸ª A/B æµ‹è¯•ï¼Œå¹¶èƒ½åˆç†åœ°è§£è¯»ç»Ÿè®¡ç»“è®ºï¼ŒæŒ‡å¯¼åç»­ç”Ÿäº§å®è·µï¼›

å¯¹äºå‰è€…ï¼Œä¸šç•Œå·²ç»æœ‰è®¸å¤šæœ€ä½³å®è·µï¼Œæ¯”å¦‚ä¹‹å‰å¼•æˆ‘å…¥é—¨çš„è¿™ç¯‡è®ºæ–‡ [Overlapping Experiment Infrastructure](https://static.googleusercontent.com/media/research.google.com/zh-CN//pubs/archive/36500.pdf)ï¼Œä»¥åŠä¼´é±¼çš„å°ä¼™ä¼´ä»¬å†™çš„ä¸¤ç¯‡å®è·µæ€»ç»“ [[1](https://xie.infoq.cn/article/d62fed8fdfdf87ec1d9779f79)]ã€[[2](https://tech.ipalfish.com/blog/2020/06/25/ab_test_evolu/)]ï¼›æœ¬æ–‡æƒ³èŠçš„æ˜¯åè€…ã€‚

<!--more-->

## 1. ä¸€æ¬¡å®éªŒ

åœ¨äº’è”ç½‘åœºæ™¯ä¸­ï¼Œæ— è®ºæ˜¯æ‹‰æ–°ã€æ¿€æ´»ã€ç•™å­˜ã€ä¿ƒæ´»è¿˜æ˜¯å•†ä¸šåŒ–ï¼Œæ‰€æœ‰çš„ A/B æµ‹è¯•éƒ½å¯ä»¥ç”¨ä¸€ä¸ªå…¬å¼æ¥æ¦‚æ‹¬ï¼š

> ğŸ’¡ æ–¹æ¡ˆ A çš„è½¬åŒ–ç‡æ¯”æ–¹æ¡ˆ B çš„æ›´é«˜å—ï¼Ÿ

ä¸ºäº†åç»­çš„è®¨è®ºèƒ½æ›´å…·ä½“ä¸€äº›ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªå®é™…çš„æµ‹è¯•åœºæ™¯ï¼šå‡è®¾æˆ‘ä»¬éœ€è¦ç»™æŸä¸ªç”¨æˆ·ç¾¤ä½“æ‹¨æ‰“ AI ç”µè¯ï¼Œä¹‹å‰ä¸€ç›´åœ¨ä½¿ç”¨å®¶çªçš„å£°éŸ³æ‹¨æ‰“ç”µè¯ï¼Œç°åœ¨ä¾›åº”å•†æ–°æ¨å‡ºäº†å°çº¢çš„å£°éŸ³ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“å°çº¢çš„å£°éŸ³æ˜¯å¦æœ‰æ›´å¥½çš„è¡¨ç°ã€‚äºæ˜¯ï¼Œåœ¨å…¶å®ƒæ¡ä»¶ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ†åˆ«ç”¨å°çº¢å’Œå®¶çªçš„å£°éŸ³ç»™è‹¥å¹²ç”¨æˆ·æ‰“äº†ç”µè¯ï¼Œè¿™æ¬¡çš„å®éªŒç°è±¡å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š

| å®éªŒç°è±¡ | å°çº¢    | å®¶çª    |
| ---- | ----- | ----- |
| æ¥é€š   | 3469  | 2798  |
| æ„å‘   | 98    | 43    |
| æ„å‘ç‡  | 2.83% | 1.54% |

å¥—ç”¨åˆšæ‰çš„å…¬å¼ï¼Œè¿™ä¸ª A/B æµ‹è¯•å°±æ˜¯ï¼š

> å°çº¢å£°éŸ³çš„æ„å‘ç‡æ¯”å®¶çªå£°éŸ³çš„æ›´é«˜å—ï¼Ÿ

### 1.1 ä»ç°è±¡åˆ°ç»“è®º

ä»ç°è±¡èµ°åˆ°ç»“è®ºçš„æ–¹å¼æœ‰ä¸¤ç±»ï¼Œå³ç»éªŒåˆ¤æ–­å’Œç»Ÿè®¡åˆ†æã€‚ç»éªŒåˆ¤æ–­å°±æ˜¯åŸºäºæ£€ç´¢çš„åˆ†æï¼Œä»ä¸€ä¸ªäººè¿‡å»çš„ç»å†ä¸­æ‰¾åˆ°æœ€ç›¸ä¼¼çš„æƒ…å†µï¼Œç„¶ååŸºäºå®ƒä»¬æ¥ç¡®å®šç»“è®ºï¼›ç»Ÿè®¡åˆ†æå°±æ˜¯åŸºäºæ¦‚ç‡çš„åˆ†æï¼Œä»ä¸€ä¸ªç°è±¡å‡ºç°çš„æ¦‚ç‡å¤§å°æ¥å†³å®šæ¥å—å“ªç§ç»“è®ºã€‚ä»¥åˆšæ‰è¿™ä¸ªå®éªŒä¸ºä¾‹ï¼Œæˆ‘ä»¬å…³å¿ƒçš„ç»“è®ºæ— éå°±æ˜¯ä¸¤ç§ï¼š

- å°çº¢å£°éŸ³çš„æ„å‘ç‡æ¯”å®¶çªå£°éŸ³çš„æ›´é«˜

- å°çº¢å£°éŸ³çš„æ„å‘ç‡æ²¡æœ‰æ¯”å®¶çªå£°éŸ³çš„æ›´é«˜

ç”±äºæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ AI ç”µè¯è§¦è¾¾ç”¨æˆ·ï¼Œè¿‡å¾€çš„ç»éªŒå¯¹æˆ‘ä»¬å¸®åŠ©ä¸å¤§ï¼Œå› æ­¤ç»Ÿè®¡åˆ†æå°±æ˜¯å”¯ä¸€çš„ä¾é ã€‚

### 1.2 ä»ç»“è®ºåˆ°äº‹å®

ç»“è®ºå’Œäº‹å®å¯èƒ½ä¸€è‡´ï¼Œä¹Ÿå¯èƒ½ä¸ä¸€è‡´ï¼Œè¿˜æ˜¯ä»¥åˆšæ‰çš„ AI ç”µè¯ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç»“è®ºå’Œäº‹å®çš„å…³ç³»æ•´ç†æˆä¸‹è¡¨ï¼š

| ç»“è®º\\äº‹å®          | CR(å°çº¢) > CR(å®¶çª) | CR(å°çº¢) â‰¤ CR(å®¶çª) |
| --------------- | --------------- | --------------- |
| CR(å°çº¢) > CR(å®¶çª) | âœ…               | âŒ               |
| CR(å°çº¢) â‰¤ CR(å®¶çª) | âŒ               | âœ…               |

å‡ºç°ä¸ä¸€è‡´çš„åŸå› ä¸»è¦åœ¨äºï¼Œè€ƒè™‘åˆ°æˆæœ¬å› ç´ ï¼Œæ¯æ¬¡å®éªŒä½¿ç”¨çš„æ˜¯æ€»ä½“äººç¾¤çš„ä¸€å°éƒ¨åˆ†ï¼Œå³æ‰€è°“çš„æ ·æœ¬ã€‚æ ·æœ¬å¯¹æ€»ä½“çš„ä»£è¡¨æ€§å–å†³äºå®ƒåœ¨æ€»ä½“ä¸­çš„åˆ†å¸ƒæ˜¯å¦è¶³å¤Ÿå‡åŒ€ï¼š

![](./polulation-sample.png)

## 2. ä¸¤ç§é”™è¯¯

å½“ç»“è®ºå’Œäº‹å®ä¸ç¬¦æ—¶ï¼Œå¯èƒ½äº§ç”Ÿä¸¤ç§é”™è¯¯ï¼š

| ç»“è®º\\äº‹å®          | CR(å°çº¢) > CR(å®¶çª) | CR(å°çº¢) â‰¤ CR(å®¶çª) |
| --------------- | --------------- | --------------- |
| CR(å°çº¢) > CR(å®¶çª) | âœ…               | âŒÂ  è¯¯ä»¥ä¸ºå‘ç°æ›´å¥½çš„æ–¹æ¡ˆ   |
| CR(å°çº¢) â‰¤ CR(å®¶çª) | âŒÂ  é”™è¿‡æ›´å¥½çš„æ–¹æ¡ˆ      | âœ…               |

å®ƒä»¬åˆ†åˆ«æ˜¯ã€Œè¯¯ä»¥ä¸ºå‘ç°æ›´å¥½çš„æ–¹æ¡ˆã€å’Œã€Œé”™è¿‡æ›´å¥½çš„æ–¹æ¡ˆã€ã€‚ä»å¯èƒ½çš„ç»“æœä¸Šçœ‹ï¼Œå‰è€…å¯èƒ½å¯¼è‡´ç³»ç»Ÿè®¾è®¡è€…åœ¨é”™è¯¯çš„æ–¹å‘ä¸Šæ¨è¿›ï¼Œå¯¹ä¸šåŠ¡ç›´æ¥é€ æˆè´Ÿé¢å½±å“ï¼›åè€…åˆ™ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ï¼Œä½†ä¸šåŠ¡åœ¨å¢é•¿ä¸Šé”™è¿‡äº†ä¸€ä¸ªå‘åŠ›ç‚¹ã€‚ä»å±é™©ç¨‹åº¦ä¸Šçœ‹ï¼Œå‰è€…æ›´å¤§ï¼Œåè€…æ›´å°ï¼Œä¹Ÿå—æ­¤å½±å“ï¼Œå®é™…å·¥ä½œä¸­äººä»¬å¾€å¾€ä¼šæ›´å…³æ³¨ç¬¬ä¸€ç±»é”™è¯¯ã€‚

ä¸¤ç§é”™è¯¯ä¹‹é—´å­˜åœ¨æ­¤æ¶ˆå½¼é•¿çš„å…³ç³»ï¼šå¦‚æœæˆ‘ä»¬è¿‡åˆ†å¼ºè°ƒé¿å…ç¬¬ä¸€ç±»é”™è¯¯ï¼Œåˆ¤æ–­æ—¶å°±å€¾å‘äºä½¿ç”¨æ›´ä¿å®ˆçš„ç­–ç•¥ï¼Œè¿‡äºä¿å®ˆå°±å®¹æ˜“çŠ¯ç¬¬äºŒç±»é”™è¯¯ï¼›åä¹‹ï¼Œå¦‚æœæˆ‘ä»¬è¿‡åˆ†å¼ºè°ƒé¿å…ç¬¬äºŒç±»é”™è¯¯ï¼Œåˆ¤æ–­æ—¶å°±å€¾å‘äºä½¿ç”¨æ›´æ¿€è¿›çš„ç­–ç•¥ï¼Œè¿‡äºæ¿€è¿›å°±å®¹æ˜“çŠ¯ç¬¬ä¸€ç±»é”™è¯¯ã€‚

ä¸¤ç§é”™è¯¯ä¹‹é—´å­˜åœ¨äº’æ–¥å…³ç³»ï¼šåœ¨å®é™…çš„ä¸€æ¬¡ç»“è®ºåˆ¤æ–­ä¸­ï¼Œå¦‚æœç»“è®ºæ˜¯ A æ–¹æ¡ˆæ¯” B æ–¹æ¡ˆå¥½ï¼Œå°±åªå¯èƒ½çŠ¯ç¬¬ä¸€ç±»é”™è¯¯ï¼›å¦‚æœç»“è®ºæ˜¯ A æ–¹æ¡ˆæ²¡æœ‰æ¯” B æ–¹æ¡ˆå¥½ï¼Œå°±åªå¯èƒ½çŠ¯ç¬¬äºŒç±»é”™è¯¯ã€‚ä¸€ä¸ªç»“è®ºä¸ä¼šåŒæ—¶çŠ¯ä¸¤ç±»é”™è¯¯ã€‚

## 3. ä¸‰ä¸ªç›´è§‰

### 3.1 ç»Ÿè®¡åˆ†æä¹Ÿæ˜¯åœ¨çŒœï¼Œåªæ˜¯çŒœå¾—æ›´æœ‰ç« æ³•

åœ¨åšä»»ä½•ç»Ÿè®¡åˆ†æä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè®¾å®šè‡ªå·±çš„ä¿¡ä»° â€” Î± å’Œ Î²ã€‚

| ç»“è®º\\äº‹å®          | CR(å°çº¢) > CR(å®¶çª) | CR(å°çº¢) â‰¤ CR(å®¶çª) |
| --------------- | --------------- | --------------- |
| CR(å°çº¢) > CR(å®¶çª) | 1 - Î±           | Î±               |
| CR(å°çº¢) â‰¤ CR(å®¶çª) | Î²               | 1 - Î²           |

Î± å°±æ˜¯çŠ¯ç¬¬ä¸€ç±»é”™è¯¯çš„æ¦‚ç‡ï¼›Î² å°±æ˜¯çŠ¯ç¬¬äºŒç±»é”™è¯¯çš„æ¦‚ç‡ï¼Œè¿™ä¸¤ä¸ªå€¼ç¡®å®šäº†æˆ‘ä»¬çš„é£é™©åå¥½ã€‚å‡è®¾ Î± = 5%ï¼Œæ„å‘³ç€å¦‚æœç»“è®ºæ˜¯ A æ–¹æ¡ˆæ¯” B æ–¹æ¡ˆå¥½ï¼Œæˆ‘ä»¬æœ‰ 5% çš„æ¦‚ç‡ä¼šè¯¯ä»¥ä¸ºå‘ç°æ›´å¥½çš„æ–¹æ¡ˆï¼›å‡è®¾ Î² = 20%ï¼Œæ„å‘³ç€å¦‚æœç»“è®ºæ˜¯ A æ–¹æ¡ˆæ²¡æœ‰ B æ–¹æ¡ˆå¥½ï¼Œæˆ‘ä»¬æœ‰ 20% çš„æ¦‚ç‡ä¼šé”™è¿‡æ›´å¥½çš„æ–¹æ¡ˆã€‚

ä¹‹åç»Ÿè®¡åˆ†æçš„å·¥ä½œå°±æ˜¯é€šè¿‡å¯¹äººç¾¤åˆ†å¸ƒçš„ç†è§£æ¥æ„å»ºæ¦‚ç‡æ¨¡å‹ï¼Œç„¶åæŒ‰ç…§æˆ‘ä»¬è®¾å®šçš„ä¿¡ä»°æ¥ä½œå‡ºåˆ¤æ–­ã€‚æ‰€ä»¥ç»Ÿè®¡åˆ†æä¹Ÿæ˜¯åœ¨çŒœï¼Œåªæ˜¯çŒœçš„æ—¶å€™ï¼Œæˆ‘ä»¬çŸ¥é“è‡ªå·±çŠ¯é”™çš„æ¦‚ç‡ï¼Œé‡‡ç”¨æ¿€è¿›çš„ç­–ç•¥æ—¶ä¹Ÿèƒ½å¯¹çŠ¯é”™çš„ç»“æœæœ‰å¿ƒç†é¢„æœŸã€‚

### 3.2 å‡è®¾æ£€éªŒå°±æ˜¯åœ¨ç¡®è®¤ç°è±¡æ˜¯å¦æ˜¯å·§åˆ

å‡è®¾æ£€éªŒçš„åŸºæœ¬è¿‡ç¨‹æ˜¯ï¼š

1. å‡è®¾æˆ‘ä»¬ä¸ç›¸ä¿¡çš„ç»“è®ºæ­£ç¡®

2. è¯æ˜è§‚æµ‹åˆ°çš„ç°è±¡æ˜¯ä¸€ä¸ªå°æ¦‚ç‡äº‹ä»¶

3. æ‹’ç»å‡è®¾ï¼Œé€‰æ‹©æˆ‘ä»¬ç›¸ä¿¡çš„ç»“è®º

ä»¥å°çº¢å’Œå®¶çªçš„å£°éŸ³é€‰æ‹©æµ‹è¯•ä¸ºä¾‹ï¼Œå®ƒçš„è¿‡ç¨‹å°±æ˜¯ï¼š

1. å‡è®¾ï¼šå°çº¢å£°éŸ³çš„æ„å‘ç‡æ²¡æœ‰æ¯”å®¶çªå£°éŸ³çš„æ›´é«˜

2. è¯æ˜è§‚æµ‹åˆ°çš„æ•°æ®å‡ºç°çš„æ¦‚ç‡å°äº 5%

3. æ‹’ç»å‡è®¾ï¼Œè®¤ä¸ºå°çº¢å£°éŸ³çš„æ„å‘ç‡æ¯”å®¶çªçš„å£°éŸ³æ›´é«˜

ä¸€ä¸ªå…·ä½“çš„è¯æ˜è¿‡ç¨‹å¯ä»¥ä»¥é™„å½•ä¸­çš„ Permutation Test ä¸ºå‚è€ƒï¼Œæœ¬èŠ‚ä¸æ·±å…¥è®¨è®ºã€‚

### 3.3 æˆæœ¬ä¸æ˜¯é—®é¢˜ä¹‹å‰ï¼Œæ ·æœ¬é‡è¶Šå¤§è¶Šå¥½

#### 3.3.1 æ ·æœ¬é‡å¯¹ç¬¬ä¸€ç±»é”™è¯¯çš„å½±å“

ä¸‹é¢è¿™å¼  GIF å›¾æ˜¯ä»åŒä¸€ä¸ªæ€»ä½“ä¸­å¤šæ¬¡é‡‡æ ·çš„åˆ†å¸ƒç»“æœï¼Œå·¦å›¾çš„æ ·æœ¬é‡ä¸º 20ï¼Œå³å›¾çš„æ ·æœ¬é‡ä¸º 500ã€‚

![](./type-1-error.gif)

å·¦å›¾ä¸­ï¼ŒAã€B ä¸¤ç»„é‡‡æ ·çš„ç»“æœå·®å¼‚å˜åŒ–å¾ˆå¤§ï¼Œæœ‰æ—¶å€™ A çœ‹èµ·æ¥æ¯” B å¥½ï¼Œæœ‰æ—¶å€™çœ‹èµ·æ¥ä¸€æ ·å¥½ï¼Œæœ‰æ—¶å€™çœ‹èµ·æ¥æ¯” B æŸ¥ï¼›å³å›¾ä¸­ï¼ŒAã€B ä¸¤ç»„é‡‡æ ·çš„ç»“æœå·®å¼‚å˜åŒ–å¾ˆå°ï¼Œçœ‹èµ·æ¥ä¸¤ç»„é‡‡æ ·çš„åˆ†å¸ƒæ€»æ˜¯æ¯”è¾ƒç±»ä¼¼ã€‚å³æ ·æœ¬é‡è¾ƒå°æ—¶ï¼ŒA æ›´å®¹æ˜“è¢«è¯¯åˆ¤ä¸ºæ›´å¥½çš„æ–¹æ¡ˆï¼Œè€Œ**æ ·æœ¬é‡çš„å¢åŠ å¯ä»¥é™ä½ç¬¬ä¸€ç±»é”™è¯¯çš„å‘ç”Ÿæ¦‚ç‡**ã€‚

#### 3.3.2 æ ·æœ¬é‡å¯¹ç¬¬äºŒç±»é”™è¯¯çš„å½±å“

ä¸‹é¢çš„ä¸¤å¼  GIF å›¾æ˜¯ä»ä¸¤ä¸ªä¸åŒçš„æ€»ä½“ä¸­å¤šæ¬¡é‡‡æ ·çš„åˆ†å¸ƒç»“æœï¼Œæ ·æœ¬é‡åˆ†åˆ«ä¸º 10 å’Œ 100ã€‚

![](./type-2-error-1.gif)

![](./type-2-error-2.gif)

æ ·æœ¬é‡ä¸º 10 æ—¶ï¼ŒB çš„åˆ†å¸ƒæœ‰æ—¶å€™ä¼šè·‘åˆ° A çš„å·¦è¾¹ï¼Œå³çŠ¯ç¬¬äºŒç±»é”™è¯¯ï¼›æ ·æœ¬é‡ä¸º 100 æ—¶ï¼ŒB çš„åˆ†å¸ƒæ€»æ˜¯åœ¨ A çš„å³è¾¹ï¼Œç¬¦åˆé¢„æœŸã€‚å› æ­¤**æ ·æœ¬é‡çš„å¢åŠ å¯ä»¥é™ä½ç¬¬äºŒç±»é”™è¯¯çš„å‘ç”Ÿæ¦‚ç‡**ã€‚

#### 3.3.3 æ ·æœ¬é‡è¶Šå¤§è¶Šå¥½

ä»ä¸Šé¢ä¸¤ç»„ GIF å›¾ä¸­ï¼Œå¯ä»¥ç›´è§‚åœ°çœ‹å‡ºï¼Œå¢åŠ æ ·æœ¬é‡å¯ä»¥åŒæ—¶é™ä½ç¬¬ä¸€ç±»å’Œç¬¬äºŒç±»é”™è¯¯å‘ç”Ÿçš„æ¦‚ç‡ã€‚

## 4. å°è¯•åšä¸€ä¸ª A/B æµ‹è¯•

äº†è§£äº†ã€Œä¸€æ¬¡å®éªŒã€ä¸¤ç§é”™è¯¯ã€ä¸‰ä¸ªç›´è§‰ã€ä¹‹åï¼Œæˆ‘ä»¬å°±æ¥å°è¯•åšä¸€ä¸ªå®Œæ•´çš„ A/B å®éªŒã€‚

### 4.1 è®¡ç®—æœ€å°æ ·æœ¬é‡

å°½ç®¡ç›´è§‰è¯´æ ·æœ¬é‡è¶Šå¤§è¶Šå¥½ï¼Œä½†å®é™…æƒ…å†µä¸‹æµé‡èµ„æºå³éæ— é™ã€ä¹Ÿéå¬ä¹‹å³æ¥ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—ä¸€ä¸ªæœ€å°çš„æ ·æœ¬é‡ã€‚ç½‘ä¸Šå¯ä»¥æ‰¾åˆ°ä¸€äº›å¼€ç®±å³ç”¨çš„æœ€å°æ ·æœ¬é‡è®¡ç®—å™¨ï¼Œè¿™é‡Œä»¥ [Sample Size Calculator (Evanâ€™s Awesome A/B Tools)](https://www.evanmiller.org/ab-testing/sample-size.html) ä¸ºä¾‹ï¼š

![](./calculate-min-sample-size.png)

å›¾ä¸­æœ‰ 4 ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼š

| å‚æ•°                        | å«ä¹‰      |
| ------------------------- | ------- |
| Baseline conversion rate  | åŸºå‡†è½¬åŒ–ç‡   |
| Minimum Detectable Effect | æœ€å°å¯å‘ç°æ•ˆæœ |
| Statistical power 1-Î²     | ç»Ÿè®¡åŠŸæ•ˆ    |
| Significance level Î±      | æ˜¾è‘—æ€§æ°´å¹³   |

ç”±äºä¹‹å‰ä½¿ç”¨çš„æ˜¯å®¶çªï¼Œå®¶çªçš„æ„å‘ç‡åœ¨ 2% å·¦å³ï¼Œå› æ­¤åŸºå‡†è½¬åŒ–ç‡é€‰æ‹© 2%ï¼›æˆ‘ä»¬é¢„ä¼°å°çº¢æ¯”å®¶çªèƒ½å¸¦æ¥ 1% ä»¥ä¸Šçš„æ„å‘ç‡æ”¹è¿›ï¼Œå› æ­¤æœ€å°å¯å‘ç°æ•ˆæœé€‰æ‹© 1%ï¼Œå¦‚æœåç»­å‘ç°è¿™ä¸ªæ”¹è¿›å¹¶æ²¡æœ‰ 1% å¯ä»¥å†å›æ¥è°ƒæ•´ã€‚æœ€å Î± å’Œ Î² çš„é€‰æ‹©å°±æ˜¯æˆ‘ä»¬çš„ä¿¡ä»° â€” é£é™©åå¥½ï¼Œå¦‚æœä½ ä¸çŸ¥é“è¯¥é€‰ä»€ä¹ˆï¼Œæœ€ä½³å®è·µå°±æ˜¯ Î± = 5%ï¼ŒÎ² = 20%ã€‚

ä¸€é€šæ“ä½œä¸‹æ¥åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ªæ–¹æ¡ˆçš„æ ·æœ¬æ•°æœ€å°å€¼ä¸º 3292ã€‚

### 4.2 çº¿ä¸Šæ‰§è¡Œ A/B åˆ†æµ

å„å¤§å…¬å¸éƒ½æœ‰è‡ªå·±çš„ A/B å¹³å°å®ç°ï¼Œè¿™é‡ŒæŒ‰ä½ä¸è¡¨ã€‚æ‰§è¡Œæ—¶åŠ¡å¿…ä¿è¯æ¯ä¸ªæ–¹æ¡ˆçš„æ ·æœ¬æ•°é‡å¤§äºæœ€å°å€¼ã€‚æœ¬æ–‡å¼€å¤´ç»™å‡ºçš„å®éªŒç°è±¡ä¸­ï¼Œå®¶çªå£°éŸ³å¯¹åº”çš„æ ·æœ¬æ•°é‡åªæœ‰ 2798ï¼Œå°äºæœ€å°æ ·æœ¬æ•°é‡ï¼Œå› æ­¤è¿˜éœ€è¦è¡¥å……ä¸€éƒ¨åˆ†å®¶çªå£°éŸ³çš„å®éªŒæ•°æ®ã€‚

### 4.3 è¿è¡Œå‡è®¾æ£€éªŒ

è¿™é‡Œæˆ‘æ¨èçš„æ˜¯ Permutation Testï¼Œè¯¦ç»†åŸç†è¯·çœ‹é™„å½•ã€‚æˆ‘åˆ©ç”¨ Google çš„ Colab åšäº†ä¸€ä¸ªåœ¨çº¿å¯æ‰§è¡Œçš„[å‡è®¾æ£€éªŒç¨‹åº](https://colab.research.google.com/drive/16E9Zk0BhLmKb_nuiPMRgzhnvgZWJCyxG#scrollTo=nPZQhldee09R)ï¼Œæ‰“å¼€ä»¥åå°†å®éªŒæ•°æ®åˆ†åˆ«å¡«å…¥ `total_A`ã€`succ_A`ã€`total_B` å’Œ `succ_B` ä¸­ï¼Œå‡è®¾å®éªŒç°è±¡æ˜¯ï¼š

| ç°è±¡  | å°çº¢   | å®¶çª   |
| --- | ---- | ---- |
| æ¥é€š  | 3469 | 3357 |
| æ„å‘  | 98   | 52   |

 é‚£ä¹ˆå¡«å…¥çš„å€¼åˆ†åˆ«ä¸º 3469ã€98ã€3357ã€52ã€‚æ‰§è¡Œçš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](./permutation-test.png)

è¿™é‡Œå¾—åˆ°çš„ p åªè¦å°äºæˆ‘ä»¬ä¿¡ä»°ä¸­çš„ Î±ï¼Œå°±å¯ä»¥è®¤ä¸ºå°çº¢å£°éŸ³çš„æ„å‘ç‡é«˜äºå®¶çªï¼Œä¸”è¯¥ç»“è®ºé”™è¯¯çš„æ¦‚ç‡ä¸ºä¸‡åˆ†ä¹‹ä¸€ã€‚å³ä¾¿ä½ æ˜¯ä¸€ä½é£é™©åŒæ¶è€…ï¼Œé¢å¯¹è¿™æ ·çš„é”™è¯¯ç‡åº”è¯¥ä¹Ÿå¯ä»¥æ”¾å®½å¿ƒäº†ã€‚

å‡è®¾å®éªŒç°è±¡æ˜¯ï¼š

| ç°è±¡  | å°çº¢   | å®¶çª   |
| --- | ---- | ---- |
| æ¥é€š  | 3469 | 3357 |
| æ„å‘  | 98   | 80   |

æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](./permutation-test-2.png)

è¿™é‡Œå¾—åˆ°çš„ p å¤§äº Î±ï¼Œå°±åº”è¯¥è®¤ä¸ºå°çº¢å£°éŸ³çš„æ„å‘ç‡æ²¡æœ‰æ¯”å®¶çªæ›´é«˜ï¼Œè¯¥ç»“è®ºçš„é”™è¯¯ç‡æœ€å¤§ä¸º Î²ï¼Œå³ 20%ã€‚

## 5. é™„å½•

### 5.1 åŸºäº Permutation Test çš„å‡è®¾æ£€éªŒ

ä»¥ä¸‹é¢çš„å®éªŒç°è±¡ä¸ºä¾‹ï¼š

|     | A     | B     |
| --- | ----- | ----- |
| æ¥é€š  | 3469  | 2798  |
| æ„å‘  | 98    | 43    |
| æ„å‘ç‡ | 2.83% | 1.54% |

ä»ç»å¯¹æ•°å€¼ä¸Šçœ‹ï¼ŒA æ–¹æ¡ˆçš„æ„å‘ç‡è¦é«˜äº B æ–¹æ¡ˆï¼Œä¼¼ä¹æ„å‘³ç€ A æ–¹æ¡ˆæ›´å¥½ã€‚æ–¹æ¡ˆ A çœŸçš„æ›´å¥½å—ï¼Ÿè¿™æ¬¡å®éªŒçš„ç»“æœæœ‰å¯èƒ½åªæ˜¯ä¸ªå·§åˆå—ï¼ŸåŸºäºæ­¤ï¼Œæˆ‘ä»¬çš„å‡è®¾å¦‚ä¸‹ï¼š

* é›¶å‡è®¾ï¼šæ–¹æ¡ˆ A å’Œæ–¹æ¡ˆ B æ²¡æœ‰å·®åˆ«

* å¤‡æ‹©å‡è®¾ï¼šæ–¹æ¡ˆ A æ¯”æ–¹æ¡ˆ B æ›´å¥½

ä¸‹é¢ä½¿ç”¨çš„å‡è®¾æ£€éªŒæ–¹æ³•å« Permutation Testï¼Œä¸»è¦å› ä¸ºå®ƒ[å¾ˆç¬¦åˆç›´è§‰ï¼Œæ²¡æœ‰å‚æ•°ï¼Œæ— æ•°å­¦å…¬å¼](https://www.jwilber.me/permutationtest/)ã€‚Permutation Test åšçš„äº‹æƒ…å¾ˆç®€å•ï¼Œå°±æ˜¯æŠŠå½“å‰çš„æ„å‘ç”¨æˆ· (98+43=141) é‡æ–°éšæœºæ‰“æ•£åˆ†é…åˆ°æ± å­ (3469+2798 = 6267) ä¸­ï¼Œç„¶åä»æ± å­ä¸­éšæœºå– 3469 ä¸ªç”¨æˆ·å½’å±äº A æ–¹æ¡ˆï¼Œå‰©ä¸‹çš„å½’å±äº B æ–¹æ¡ˆã€‚ä»¥ä¸Šå°±æ˜¯ä¸€æ¬¡éšæœºåˆ†é…çš„æ¨¡æ‹Ÿå®éªŒã€‚å‡è®¾å•æ¬¡æ¨¡æ‹Ÿå®éªŒåæœ‰ X ä¸ªç”¨æˆ·å½’å±äº A æ–¹æ¡ˆï¼ŒY ä¸ªç”¨æˆ·å½’å±äº B æ–¹æ¡ˆï¼Œé‚£ä¹ˆ Xã€Y å–å€¼èŒƒå›´å°±æ˜¯æ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„ä»»æ„ç»„åˆï¼š

$$
X + Y = 141, X \ge 0, Y \ge 0
$$

å¦‚æœé‡å¤åš 10000 æ¬¡è¿™æ ·çš„æ¨¡æ‹Ÿå®éªŒï¼Œå¹¶ä»¥ X-Y (è¿™é‡Œä»¥ X-Yã€Y-Xã€X æˆ–è€… Y ä¸ºä¾‹çš†å¯) çš„å€¼ä¸ºæ¨ªåæ ‡ï¼Œå–å€¼èŒƒå›´ä¸º `[-141, 141]`ï¼Œå…¶å„ä¸ªå–å€¼çš„å‡ºç°é¢‘æ¬¡ `Freq(X-Y)` ä¸ºçºµåæ ‡ï¼Œå°±å¾ˆå®¹æ˜“å¾—åˆ°ä¸€ä¸ªé’Ÿå‹æ›²çº¿ï¼š

![éšæœºå˜é‡ X-Y çš„é¢‘ç‡ç›´æ–¹å›¾](./freq-x.png)

å®ƒå°±æ˜¯éšæœºå˜é‡ X-Y çš„é¢‘åº¦ç›´æ–¹å›¾ï¼Œç†è®ºä¸Šå®ƒçš„å½¢çŠ¶åº”è¯¥è¶‹è¿‘äºå˜é‡ X-Y çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚æœ‰äº† X-Y çš„é¢‘åº¦ç›´æ–¹å›¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ°æœ¬èŠ‚åˆæåˆ°çš„å®éªŒç»“æœ (x-y = 55) åœ¨ç›´æ–¹å›¾ä¸­çš„ä½ç½®ï¼š

![åŠ ä¸Šæ ‡è®°é¢‘ç‡ç›´æ–¹å›¾](./freq-x-with-mark.png)

åˆ©ç”¨ x-y åœ¨é¢‘åº¦ç›´æ–¹å›¾ä¸­çš„ä½ç½®ï¼Œæˆ‘ä»¬å°±èƒ½ä¼°ç®—å‡º x-y åœ¨éšæœºå˜é‡ X-Y æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸Šçš„åˆ†ä½ç‚¹ã€‚åœ¨ä¸€æ¬¡æ¨¡æ‹Ÿå®éªŒä¸­ï¼Œæˆ‘ä»¬ç®—å¾—çš„åˆ†ä½ç‚¹ä¸º 99.95%ï¼Œè¿™æ„å‘³ç€ã€Œå¦‚æœé›¶å‡è®¾æˆç«‹ï¼Œè§‚æµ‹åˆ° x-y >= 55 çš„æ¦‚ç‡ä¸º 0.05% (1-99.95%)ã€ï¼Œå³åšä¸€ä¸‡æ¬¡å®éªŒï¼Œåªæœ‰äº”æ¬¡èƒ½è§‚æµ‹åˆ° x-y >= 55ã€‚è¿™æ˜¯ä¸ªå°æ¦‚ç‡äº‹ä»¶ï¼Œæˆ‘ä»¬æœ‰å……è¶³çš„ä¿¡å¿ƒé€‰æ‹©æ‹’ç»é›¶å‡è®¾ï¼Œç›¸ä¿¡å¤‡æ‹©å‡è®¾ï¼Œå¦‚æœä¸€å®šè¦ç»™è¿™ä¸ªä¿¡å¿ƒåŠ ä¸€ä¸ªæ•°å­—ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ 99.95%ã€‚

å¦‚æœä½ å¬è¿‡è’™ç‰¹å¡æ´›æ–¹æ³• (Monte Carlo Method)ï¼Œåˆšæ‰è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿã€‚å®ç°é€»è¾‘å¯ä»¥å‚è€ƒæˆ‘çš„è¿™ç¯‡ gist [AB-Permutation-Test Â· GitHub](https://gist.github.com/ZhengHe-MD/48e633ec49a35b5259908cf468dc073b)ã€‚

## å‚è€ƒ

* [Hacking Growth](https://www.goodreads.com/book/show/31625067-hacking-growth)

* [The Permutation Test]([Permutation Test: Visual Explanation](https://www.jwilber.me/permutationtest/))

* [Statistical Significance in A/B testing (Calculation, p-value and the Math)](https://data36.com/statistical-significance-in-ab-testing/)

* [AB-Permutation-Test Â· GitHub](https://gist.github.com/ZhengHe-MD/48e633ec49a35b5259908cf468dc073b), [Colab](https://colab.research.google.com/drive/16E9Zk0BhLmKb_nuiPMRgzhnvgZWJCyxG#scrollTo=JJ73psUwe9GF)

* [Sample Size Calculator (Evanâ€™s Awesome A/B Tools)](https://www.evanmiller.org/ab-testing/sample-size.html)

* [GIF visualizations of Type 1 and Type 2 error in relation to sample size &#8211; paulvanderlaken.com](https://paulvanderlaken.com/2019/06/12/gif-visualizations-of-type-1-and-type-2-error-in-relation-to-sample-size/)
