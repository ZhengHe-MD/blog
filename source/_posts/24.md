---
title: 纸牌游戏：24
date: 2022-10-30 21:21:09
tags:
---

可能是太想排到车号了，最近上下班路上总是盯着过往车辆的号牌。盯着盯着就会下意识地思考：「怎么用上面的数字经过加、减、乘、除得到 24」，比如下面这个车牌：

![](./car-number.jpg)

既可以 "(6 + 3) × 8 ÷ 3"，也可以 "(3 × 3 - 6) × 8"。有时候就这么算着、算着，到达目的地仍然觉得意犹未尽。

这个「下意识」的背后是一群理科少年们迷恋的游戏：24。大概是高二的时候，我与几位同学一起到厦门双十中学参加数学夏令营，其中我还记得名字的有杜远志、吴奋强、林杰、杜明树、陈庆树。夏令营里上什么课我已经完全不记得，但我仍然记得在临时宿舍里，少年们拿着几副纸牌，热火朝天地比赛心算 24。

游戏规则很简单：拿一副完整的纸牌，剔除掉大王和小王，将剩下的纸牌平均分给比赛双方。双方各自手持一组纸牌，纸牌需背面朝上。每轮游戏开始，双方同时取出最上面的两张纸牌，反手甩到桌面上，四个数字瞬间暴露在两对炯炯有神的眼睛下。谁先算出 24，就拍一下床板，然后说出解法。说对了，四张纸牌收入囊中，说错了，则拱手送人。谁把对方手上的纸牌赢光，谁便胜出。

我的记忆里仍然有许多有意思的画面：比如我拍床板时太用力，疼得嗷嗷叫，直接叫了暂停。又比如我算不过陈庆树，就哥几个一起「三英战吕布」。我记得最经典的一道题，就是 "3、3、7、7"，难倒了众多好汉。如果你也觉得有意思，不妨试试？答案在文末的代码块中。

今天早上醒来，忽然想到这不就是个「搜索问题？」对于我这个为了生活 LeetCode 400+ 的做题家来说是小菜一碟了。于是就在家里的白板上画起了思路：

![](./whiteboard.png)

最终这 4 个数字一定会和 3 个二元运算符组成一个算式，而且这个算式一定可以用上面这种语法树表示。那么我只要每次从剩余的数字中选择 2 个，再选取 1 个运算符，就可以穷举出所有可能的语法树。因为减法和除法并不具备交换性，这里选取数字的顺序是需要考虑的，这是排列，不是组合。

{% note info no-icon "代码在这里" %}  
{% gist 060aae7b993cac117b0193702c3b864c 24.go %}

{% endnote %}

写完了以后，我感到很满足。虽然不是解开了世纪难题，但也是对那段青葱岁月和快乐时光的一次回味。
